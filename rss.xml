<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[RSS Feed of modisfive's 블로그]]></title><description><![CDATA[안녕하세요 :)]]></description><link>https://modisfive.github.io</link><generator>GatsbyJS</generator><lastBuildDate>Thu, 12 Sep 2024 10:52:31 GMT</lastBuildDate><item><title><![CDATA[[Java] Exception에 대한 고찰]]></title><description><![CDATA[프로그램이 자바 언어의 제약을 벗어난다면, JVM은 Exception으로 프로그램에게 에러를 발생시킨다. 예시로 정해진 배열의 범위를 벗어나 접근하는 경우가 있다. 또한, 프로그램은 를 사용해서 명시적으로 Exception…]]></description><link>https://modisfive.github.io/java-exception/</link><guid isPermaLink="false">https://modisfive.github.io/java-exception/</guid><pubDate>Mon, 05 Aug 2024 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;프로그램이 자바 언어의 제약을 벗어난다면, JVM은 Exception으로 프로그램에게 에러를 발생시킨다. 예시로 정해진 배열의 범위를 벗어나 접근하는 경우가 있다. 또한, 프로그램은 &lt;code class=&quot;language-text&quot;&gt;throws&lt;/code&gt;를 사용해서 명시적으로 Exception을 발생시킬 수 있다. 이러한 자바의 Exception의 종류와 동작 방식 등에 대해 알아보자.&lt;/p&gt;
&lt;h2&gt;Exception의 종류&lt;/h2&gt;
&lt;figure&gt;
   &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/a32d8b4866f9de65f0a75be0e86712ff/d9f49/java-exception-hierarchy.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 81.17647058823529%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAABJ0AAASdAHeZh94AAADKElEQVR42l1RWU9TQRi9L/wCDaLUaEtsK3V7MxpN1Oi7Pmh8kBgTHlyi4v7gglFRkBBkMZHWKChSFyCIEDEqgkApvWytUIrVUqCoCC3UtvfOPg6tipqczEwy3/m+c84nUU4SwBRTCryTkereYF1/qP5DuLZvqs4VHp3+wRgiv8v+hjR3EUgQUGJRCsLtnqnjlcNH78pZFc7MouaTVm/PSAiiGKKEcCrwPxlzjhhTEeKchxQyPE28QTw8jT4HoS8IFIQpUcVwzkUhZBzPkwlSwYms8J7doYx96q6d+HYxEz0YZgx3B9RXnkjjh5l6V7jeGWp0RxuHQGAWcCGBJcgghnQ6ryQ5kpJCkkT37oVciIEIqeW9+Eztt8Nl9kN3bJnFLaeqPDltzPVFFWScIAvDoK4Gl99HlQ9QxT1gtxFBjo/+OIP7p8nALGvzTvUHoq6JaJvn24wq9BMyH5hoFYeIjs2G2PgYnwggv4+O+/jECA/46PeA+GQUIRhjf2X2K20KYsLprNXauSBlMM3o1K7o0+ndOoMzzdibnPo144BoLVaiQJX+Q6aIYiDIIieloWFo/Ubfth2ftm4f3LDJu3mLZ9sOz4bNk6fPUc4SZBI3nICYzP7Iju+MQsaE7ZloBAlrnDEKOANx2SJFZS6Q35CgowtmXya5N2FOLs3NAznX8Y25B80vwFdzVOvj7q/4zWfU6keto/SdD4uzZQQ1+1CHX5Xg/XK4cEnfUu37FI0tRdO+KNWeoulYlCovWaYka3DGfusgKpR53tvQhWrvtZeT2c/9+a2RIplbHEBCVquiN8mr1rYYTB0rTe+MAumtRpPNtOaHYRU9cvTpgFLYppx/6DicX51V2nQw72n2E1eJHZV3K5JaVTWq03evXtdsNL3Qr3xtSBePJkO6aDesM8SOHKuSp85WyFdrh67UDF181HP52cCVGvelZ25LR3BOdmzBYiXNiLQGRauPLF8hTqA1xNKM0WQNyNj/2E0K7LxEZkUOfquLFjlYcRcv7OIWGUrQ5UQlpdhsQWVmXGaGZWaUgNmCS2+DhhcDk8DmB/ZRYB+bR+cY6AkoPwHWo+3goq/8OgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;java exception hierarchy&apos; title=&apos;&apos; src=&apos;/static/a32d8b4866f9de65f0a75be0e86712ff/d9f49/java-exception-hierarchy.png&apos; srcset=&apos;/static/a32d8b4866f9de65f0a75be0e86712ff/e7570/java-exception-hierarchy.png 170w,
/static/a32d8b4866f9de65f0a75be0e86712ff/f46e7/java-exception-hierarchy.png 340w,
/static/a32d8b4866f9de65f0a75be0e86712ff/d9f49/java-exception-hierarchy.png 400w&apos; sizes=&apos;(max-width: 400px) 100vw, 400px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
   &lt;figcaption&gt;출처: https://www.javamex.com/tutorials/exceptions/exceptions_hierarchy.shtml&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Exception은 Throwable 클래스 혹은 그 서브클래스들의 인스턴스로 표현된다. 즉, Throwable 클래스와 그의 모든 서브클래스는 모두 예외를 나타내는 클래스들이다.&lt;/p&gt;
&lt;p&gt;Throwable 클래스의 직접 서브클래스(direct subclass)로는 Exception 클래스와 Error 클래스가 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Exception 클래스는 일반적인 프로그램에서 복구를 시도할 수 있는 모든 예외의 상위 클래스이다. RuntimeException은 Exception 클래스의 직접 서브클래스이다.&lt;/li&gt;
&lt;li&gt;Error 클래스는 일반적인 프로그램에서 복구가 기대되지 않는 모든 예외의 상위 클래스이다. 대표적인 예인 &lt;code class=&quot;language-text&quot;&gt;OutOfMemoryError&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;StackOverflowError&lt;/code&gt;와 같이 발생하더라도 개발자가 어찌할 수 없다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Exception은 크게 Unchecked Exception과 Checked Exception으로 나뉜다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Unchecked Exception : Error 클래스, RuntimeException 클래스와 그의 서브 클래스를 말한다. 위 그림에서 빨간색에 해당하는 부분이다.&lt;/li&gt;
&lt;li&gt;Checked Exception : Unchecked Exception(RuntimeException) 클래스가 아닌 모든 Exception의 서브 클래스를 말한다. 위 그림에서 빨간색이 아닌 파란색에 해당하는 부분이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Unchecked Exception&lt;/h3&gt;
&lt;p&gt;Unchecked Exception은 &lt;u&gt;Error 클래스, RuntimeException 클래스와 그의 서브 클래스&lt;/u&gt;를 말한다.&lt;/p&gt;
&lt;p&gt;컴파일 타임에 예외 처리를 위한 핸들러의 유무를 확인하지 않는다. Exception 처리가 강제되지 않아 개발자가 예외 처리 핸들러를 구현하지 않아도 된다. 물론, 원하는 경우에는 &lt;code class=&quot;language-text&quot;&gt;catch&lt;/code&gt;문을 사용해서 예상되는 RuntimeException 예외를 처리해줄 수 있다.&lt;/p&gt;
&lt;p&gt;Error 클래스는 시스템 레벨의 심각한 문제를 나타내며, 일반적으로 개발자가 이를 처리할 수 있는 방법이 거의 없다. 예를 들어, &lt;code class=&quot;language-text&quot;&gt;OutOfMemoryError&lt;/code&gt;나 &lt;code class=&quot;language-text&quot;&gt;StackOverflowError&lt;/code&gt;와 같은 오류는 복구가 거의 불가능한 상황을 의미한다. 이러한 이유로 개발자는 애플리케이션 코드에서 &lt;code class=&quot;language-text&quot;&gt;Error&lt;/code&gt; 클래스에 대한 처리를 시도하지 않는 것이 일반적이다. 그렇기에 Unchecked Exception이라고 할 때는 RuntimeException과 그 하위 클래스를 주로 의미한다.&lt;/p&gt;
&lt;h3&gt;Checked Exception&lt;/h3&gt;
&lt;p&gt;Checked Exception 클래스는 &lt;u&gt;Unchecked Exception 클래스가 아닌 모든 Exception 클래스&lt;/u&gt;이다. 즉, RuntimeException 클래스 이외의 모든 Exception 클래스의 서브 클래스이다.&lt;/p&gt;
&lt;p&gt;자바는 Checked Exception에 대한 핸들러를 포함하도록 강제하여, 컴파일 타임에 Checked Exception에 대한 핸들러가 있는지 확인한다. 개발자는 예외 처리 핸들러를 반드시 포함해야 한다. &lt;code class=&quot;language-text&quot;&gt;catch&lt;/code&gt;문으로 처리하거나 &lt;code class=&quot;language-text&quot;&gt;throws&lt;/code&gt;를 이용해서 다른 곳에서 처리하도록 해야 한다. 이런 예외 처리 핸들러의 유무를 컴파일 타임에 확인함으로써 처리되지 않는 예외의 수를 줄일 수 있다.&lt;/p&gt;
&lt;h2&gt;예외 처리 방식&lt;/h2&gt;
&lt;p&gt;예외를 처리하는 방식에는 예외 복구, 예외처리 회피, 예외 전환 등 3가지 방법이 있다.&lt;/p&gt;
&lt;h3&gt;예외 복구&lt;/h3&gt;
&lt;p&gt;예외 상황을 파악하고 문제를 해결해서 정상 상태로 돌려놓는 방법이다.&lt;/p&gt;
&lt;p&gt;사용자가 특정 파일을 읽으려는데 파일이 없어 &lt;code class=&quot;language-text&quot;&gt;IOException&lt;/code&gt;이 발생하는 경우, 다른 파일을 선택하도록 유도하는 것으로 해결할 수 있다. 혹은 DB에 접속하는데에 실패하여 &lt;code class=&quot;language-text&quot;&gt;SQLException&lt;/code&gt;이 발생하는 경우, 여러 번 재시도하도록 할 수도 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; maxretry &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MAX_RETRY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;maxretry&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

   &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;SomeException&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

   &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;finally&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

   &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;RetryFailedException&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// 출처: 토비의 스프링 3.1 Vol.1 p286&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이처럼 사용자에게는 원하는 것처럼 동작하지 않았기 때문에 예외 상황으로 비쳐지더라도 애플리케이션에서는 정상적인 흐름에 따라 진행되어야 한다. 물론, 단순히 에러 메시지를 사용자에게 보여주는 것은 예외 복구로 볼 수 없다.&lt;/p&gt;
&lt;h3&gt;예외처리 회피&lt;/h3&gt;
&lt;p&gt;자신이 예외 처리를 하지 않고 자신을 호출한 곳에서 예외 처리를 하도록 던져버리는 것이다. &lt;code class=&quot;language-text&quot;&gt;throws&lt;/code&gt;문을 활용해서 예외 발생시 바로 던져버리거나, &lt;code class=&quot;language-text&quot;&gt;catch&lt;/code&gt;문으로 일단은 잡아 로그를 남기고 다시 예외를 던진다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SQLException&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SQLException&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

   &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;SQLException&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;// 로그 출력&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
   &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// 출처: 토비의 스프링 3.1 Vol.1 p287&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;예외 전환&lt;/h3&gt;
&lt;p&gt;예외처리 회피와 같이 &lt;code class=&quot;language-text&quot;&gt;throws&lt;/code&gt;를 이용해서 자신을 호출한 곳에서 예외를 처리하도록 한다. 하지만, 예외처리 회피와 달리 적절한 다른 예외로 바꾸어 던진다는 특징이 있다.&lt;/p&gt;
&lt;p&gt;예외 전환은 보통 두 가지 목적으로 사용된다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;발생한 예외를 그대로 던지는 것이 예외 상황을 적절히 설명하지 못하는 경우, 더 구체적인 의미를 가진 예외로 바꾸기 위해 사용한다.&lt;/p&gt;
&lt;p&gt;예를 들어, 새로운 사용자를 등록하는데 이미 같은 아이디의 사용자가 존재하는 경우 &lt;code class=&quot;language-text&quot;&gt;SQLException&lt;/code&gt;이 발생한다. 하지만, 외부에 그대로 &lt;code class=&quot;language-text&quot;&gt;SQLException&lt;/code&gt;을 던져버리면 서비스 계층에서는 왜 &lt;code class=&quot;language-text&quot;&gt;SQLException&lt;/code&gt;이 발생했는지, 처리할 수 있는 것인지, 어떻게 처리할 지 등을 알 수 없다. 중복된 아이디에 대한 예외는 충분히 처리할 수 있기 때문에 적절한 예외로 바꾸어 던지는 것이 좋다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;User&lt;/span&gt; user&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DuplicateUserIdException&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SQLException&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

   &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;SQLException&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getErrorCode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MysqlErrorNumbers&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;ER_DUP_ENTRY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
         &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DuplicateUserIdException&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
         &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
   &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// 출처: 토비의 스프링 3.1 Vol.1 p289&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;예외 처리를 쉽고 단순하게 만들기 위해서 사용한다.&lt;/p&gt;
&lt;p&gt;주로 예외 처리를 강제하는 Checked Exception에서 Unchecked Exception으로 바꾸는 경우에 사용한다. 예외 복구를 할 수 없거나 비즈니스적으로 의미가 없는 Checked Exception이라면 빠르게 RuntimeException으로 바꿔서 던지는 편이 좋다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;발생한 예외를 다른 예외로 전환하는 경우, 원래 발생한 예외를 담아 중첩 예외를 만드는 것이 좋다. 중첩 예외는 &lt;code class=&quot;language-text&quot;&gt;getCause()&lt;/code&gt; 메소드를 이용해서 처음 발생한 예외가 무엇인지 파악할 수 있다.&lt;/p&gt;
&lt;h2&gt;JVM에서 예외를 처리하는 방법 (예외 발생 시 동작 방법)&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;예외가 발생하면 JVM은 Exception 객체를 생성한다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Exception 객체가 생성되는 과정에서 &lt;code class=&quot;language-text&quot;&gt;fillInStackTrace&lt;/code&gt; 메소드가 호출된다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;fillInStackTrace&lt;/code&gt; 메소드 호출로 JVM은 예외 발생 시점의 호출 스택에서 각 스택 프레임 정보를 수집하고, 해당 정보가 Exception 객체의 스택 트레이스로 채워진다.&lt;/p&gt;
&lt;p&gt;이때 수집되는 스택 프레임의 정보로는 클래스 이름, 메소드 이름, 파일 이름, 라인 번호 등등이 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;// 스택 트레이스 예시
Exception in thread &quot;main&quot; java.lang.NullPointerException: Cannot load from object array because &quot;BOJ2563.papers&quot; is null
  at BOJ2563.setUp(BOJ2563.java:45)
  at BOJ2563.main(BOJ2563.java:15)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;호출된 메소드의 스택을 역순으로 올라가면서(unwinding the stack) Exception을 처리할 수 있는 예외 처리 핸들러가 있는지 확인한다.&lt;/p&gt;
&lt;figure&gt;
   &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/c71ac2635bfc89028b09808f9b2d2159/fe486/java-exception-stack-unwinding.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 56.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABzklEQVR42n1Si3KbMBD0/39Vp51pm5km46T1A2xeBmMDAkkg3thbnbCbTJv0NIsQ6FbavVvgFn3fo6oqVKrCOIxQjcI6tmAnO+wzFx4P4GscqiOaoTU5Vz3+jgU9pmkyZEVRIM9zcD0zwfDJ+oyv9jc8Rk/Y8A0sYWMltnBPPhpVf0xYliWCIJhveCPuhg6HOsKpTxG3Z8TdjIOKUA8NknOCLMvAOUfb3m58vc6E96APFFVZacIeh+KIkM8I8lCvIwQa/WWAFNLsb5oGSql/CclD+tG0DUpZwgkcI/m782CwPL1gyy08pz/hxB5KTUjRdR0YYyaX3v94SDLTNDVgGUMhObbFDl6li6EOCNsjoi7GXnqI2QlKq7gTCiHMPAzDq4dhGJpT6ro2vozTiLTMZsgMZ54gESnyusBFDzqU9lMu5fzXQ5KcFKmW/AXL+BmrfIN1sTGSV3wLOejCsQJSSlOQcRxfq0xSXdeF7/vwPC0njtFqoxlnWCYvsLkNW+heLB24yoNTu4iY7sW6wXuxIHa6MlWLQMUxRZoGPPpL/Ng/4ddxDSvbwWJ7ONKH6meJl8vl/T58G3QAeUgg6dQeNJNXJJHWggtTxLdS74S/AXQOR8ordqqxAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;java exception stack unwinding&apos; title=&apos;&apos; src=&apos;/static/c71ac2635bfc89028b09808f9b2d2159/ca1dc/java-exception-stack-unwinding.png&apos; srcset=&apos;/static/c71ac2635bfc89028b09808f9b2d2159/e7570/java-exception-stack-unwinding.png 170w,
/static/c71ac2635bfc89028b09808f9b2d2159/f46e7/java-exception-stack-unwinding.png 340w,
/static/c71ac2635bfc89028b09808f9b2d2159/ca1dc/java-exception-stack-unwinding.png 680w,
/static/c71ac2635bfc89028b09808f9b2d2159/fe486/java-exception-stack-unwinding.png 768w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
   &lt;figcaption&gt;출처: https://www.geeksforgeeks.org/exceptions-in-java/&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;만약 예외 처리 핸들러를 발견하지 못하면, JVM은 해당 스레드를 종료시키며, 메인 스레드에서 예외가 처리되지 않으면 프로그램도 종료된다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;예외 처리 비용&lt;/h2&gt;
&lt;p&gt;일반적으로 예외 처리 비용은 비싸다고 알려져 있다. 그럼 왜 비싸고, 얼마나 비싼 것일까?&lt;/p&gt;
&lt;p&gt;우선, Baeldung의 &lt;a href=&quot;https://www.baeldung.com/java-exceptions-performance&quot;&gt;Performance Effects of Exceptions in Java&lt;/a&gt; 글에서 성능 측정을 한 결과는 다음과 같았다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token class-name&quot;&gt;Benchmark&lt;/span&gt;                                                 &lt;span class=&quot;token class-name&quot;&gt;Mode&lt;/span&gt;  &lt;span class=&quot;token class-name&quot;&gt;Cnt&lt;/span&gt;    &lt;span class=&quot;token class-name&quot;&gt;Score&lt;/span&gt;   &lt;span class=&quot;token class-name&quot;&gt;Error&lt;/span&gt;  &lt;span class=&quot;token class-name&quot;&gt;Units&lt;/span&gt;
&lt;span class=&quot;token class-name&quot;&gt;ExceptionBenchmark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;createExceptionWithoutThrowingIt       avgt   &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;   &lt;span class=&quot;token number&quot;&gt;16.605&lt;/span&gt; ± &lt;span class=&quot;token number&quot;&gt;0.988&lt;/span&gt;  ms&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;op
&lt;span class=&quot;token class-name&quot;&gt;ExceptionBenchmark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;doNotThrowException                    avgt   &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;0.047&lt;/span&gt; ± &lt;span class=&quot;token number&quot;&gt;0.006&lt;/span&gt;  ms&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;op
&lt;span class=&quot;token class-name&quot;&gt;ExceptionBenchmark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;throwAndCatchException                 avgt   &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;   &lt;span class=&quot;token number&quot;&gt;16.449&lt;/span&gt; ± &lt;span class=&quot;token number&quot;&gt;0.304&lt;/span&gt;  ms&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;op
&lt;span class=&quot;token class-name&quot;&gt;ExceptionBenchmark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;throwExceptionAndUnwindStackTrace      avgt   &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;  &lt;span class=&quot;token number&quot;&gt;326.560&lt;/span&gt; ± &lt;span class=&quot;token number&quot;&gt;4.991&lt;/span&gt;  ms&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;op
&lt;span class=&quot;token class-name&quot;&gt;ExceptionBenchmark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;throwExceptionWithoutAddingStackTrace  avgt   &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;1.185&lt;/span&gt; ± &lt;span class=&quot;token number&quot;&gt;0.015&lt;/span&gt;  ms&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;op&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위 글과 &lt;a href=&quot;https://shipilev.net/blog/2014/exceptional-performance/&quot;&gt;The Exceptional Performance of Lil&apos; Exception&lt;/a&gt; 글에서의 결론은 다음과 같다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;예외가 발생하고 처리하는 과정은 일반적인 상황에 비해 더 많은 비용이 든다. 진정으로 예외가 필요한 곳에서만 예외 처리를 사용하자.&lt;/li&gt;
&lt;li&gt;try~catch문 자체는 성능에 큰 영향을 주지 않는다.&lt;/li&gt;
&lt;li&gt;예외 처리 비용의 대부분은 &lt;strong&gt;스택 트레이스를 구성하는 것&lt;/strong&gt;과 &lt;strong&gt;스택을 역순으로 따라가며 예외 처리 핸들러를 찾는 과정&lt;/strong&gt;에서 발생한다.&lt;/li&gt;
&lt;li&gt;스택 트레이스를 구성하는 데에 드는 비용은 Exception 객체가 생성되는 시점의 호출 스택 깊이에 비례한다.&lt;/li&gt;
&lt;li&gt;예외를 캐싱하거나 &lt;code class=&quot;language-text&quot;&gt;fillInStackTrace&lt;/code&gt; 메소드를 오버라이드함으로써 최적화를 이룰 수 있다. 스택 트레이스의 정보가 생성되지 않을 수 있기 때문에 매우 특수한 경우에만 진행해야 한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;(번외) Checked Exception에 대한 이슈&lt;/h2&gt;
&lt;p&gt;개발자에게 예외 처리를 강제하는 Checked Exception에 대한 이슈가 있다.&lt;/p&gt;
&lt;p&gt;무조건 예상되는 예외를 처리하도록 하여 서비스의 안정성을 도모하고자 했지만, 이를 귀찮게 느낀 개발자들은 &lt;code class=&quot;language-text&quot;&gt;catch&lt;/code&gt;문으로 잡아만 두고 아무런 처리도 하지 않는다거나, 의미 없이 &lt;code class=&quot;language-text&quot;&gt;throws Exception&lt;/code&gt;만 한다는 것이다. Checked Exception이 처음 등장했을 때와 다르게 최근에는 Unchecked Exception을 사용하자는 의견이 많아지고 있다고 한다.&lt;/p&gt;
&lt;p&gt;더 자세한 내용은 아래 글을 참고하자.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://velog.io/@eastperson/Java%EC%9D%98-Checked-Exception%EC%9D%80-%EC%8B%A4%EC%88%98%EB%8B%A4-83omm70j&quot;&gt;https://velog.io/@eastperson/Java의-Checked-Exception은-실수다-83omm70j&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;참고 자료&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;토비의 스프링 3.1 Vol.1 4장&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.oracle.com/javase/specs/jls/se22/jls22.pdf&quot;&gt;https://docs.oracle.com/javase/specs/jls/se22/jls22.pdf&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.oracle.com/javase/specs/jvms/se22/jvms22.pdf&quot;&gt;https://docs.oracle.com/javase/specs/jvms/se22/jvms22.pdf&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/36343209/which-part-of-throwing-an-exception-is-expensive&quot;&gt;https://stackoverflow.com/questions/36343209/which-part-of-throwing-an-exception-is-expensive&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.baeldung.com/java-exceptions-performance&quot;&gt;https://www.baeldung.com/java-exceptions-performance&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://shipilev.net/blog/2014/exceptional-performance/&quot;&gt;https://shipilev.net/blog/2014/exceptional-performance/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://meetup.nhncloud.com/posts/47&quot;&gt;https://meetup.nhncloud.com/posts/47&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[AWS ALB가 502를 내뱉는다]]></title><description><![CDATA[문제 발생 whileTrue 서비스를 쓰고 있는데 어느 순간부터 크롬 확장 프로그램이 제대로 동작하지 않았습니다. 콘솔을 보니 다음과 같은 에러 메시지가 출력되고 있었습니다. 에러 메시지를 자세히 보니 반환된 메시지를 JSON…]]></description><link>https://modisfive.github.io/aws-alb-502/</link><guid isPermaLink="false">https://modisfive.github.io/aws-alb-502/</guid><pubDate>Fri, 12 Apr 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;문제 발생&lt;/h2&gt;
&lt;p&gt;whileTrue 서비스를 쓰고 있는데 어느 순간부터 크롬 확장 프로그램이 제대로 동작하지 않았습니다. 콘솔을 보니 다음과 같은 에러 메시지가 출력되고 있었습니다.&lt;/p&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/de8ed2ca4013a86a806d749a13f27041/03e15/aws-alb-502-01.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 17.058823529411764%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAlElEQVR42mWL2w6DIBBE/ZVerNC0UaNCQYHloun//9CUEk2a9OHkzEx2q5gImhyEj1DOQxuHhQIobXAhFfw3xwQbYt7Xgsp32joYHzDpGUrNMORRpVw2a/EmQpzzOE1wUmIZRyzDANm2mW73Lx1efQ8rBIyQ5cdpjarmd9Sco5hxXA+aI7Md/selYTjfmuJTNns88QGMvWDDqbLGeAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;aws alb 502 01&apos; title=&apos;&apos; src=&apos;/static/de8ed2ca4013a86a806d749a13f27041/ca1dc/aws-alb-502-01.png&apos; srcset=&apos;/static/de8ed2ca4013a86a806d749a13f27041/e7570/aws-alb-502-01.png 170w,
/static/de8ed2ca4013a86a806d749a13f27041/f46e7/aws-alb-502-01.png 340w,
/static/de8ed2ca4013a86a806d749a13f27041/ca1dc/aws-alb-502-01.png 680w,
/static/de8ed2ca4013a86a806d749a13f27041/02d09/aws-alb-502-01.png 1020w,
/static/de8ed2ca4013a86a806d749a13f27041/03e15/aws-alb-502-01.png 1157w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;/figure&gt;
&lt;p&gt;에러 메시지를 자세히 보니 반환된 메시지를 JSON으로 변환하려다가 문제가 생긴 것 같았습니다. 여기서 &quot;아! JSON 객체가 넘어온 것이 아니구나!&quot;를 깨닳았습니다. 그래서 백엔드에서 반환된 메시지를 그냥 출력시켜봤는데..&lt;/p&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/daac7aea50ae49e2b704c1a5fa2a658b/68934/aws-alb-502-02.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 30.58823529411765%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABLElEQVR42o2R20oCURSG5wVMHRxS0hxPzTjjcfI8po2VPVzRvdq93QQmYmAHsbcS1K85YFhXLfj4Ye29PhZ7C7GIhKIpmC2TarVGPl8gHI4QCIr4jvz4fH4CARFJkpBCEiE7g6Jonwc5tu/FZZnoSRRZjqGpaYT3j0+WyyXz+SuDwZDR6JHhcMR4/MRi8cZq9cXd/QOG2cG87mN2LertDrVWm7Z1hXVzy0Xnkl6/T7dnIXBQ2+2W3c5h57LZbNz+y2zGaaFMqdFEM85J5/Kk9RwpTSOZ1UhlsyRVD8EZ2uNIPKmX6/XaFT5PJkRUHa1k2MM68pnyQ2KPorr5a8O/dbhhQtOp2O9crjcw7E2dLNXqqIWiJ3aENv8STqZT4pkMlWaLov1xjshJh7/Cb+M/ISyg6paFAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;aws alb 502 02&apos; title=&apos;&apos; src=&apos;/static/daac7aea50ae49e2b704c1a5fa2a658b/ca1dc/aws-alb-502-02.png&apos; srcset=&apos;/static/daac7aea50ae49e2b704c1a5fa2a658b/e7570/aws-alb-502-02.png 170w,
/static/daac7aea50ae49e2b704c1a5fa2a658b/f46e7/aws-alb-502-02.png 340w,
/static/daac7aea50ae49e2b704c1a5fa2a658b/ca1dc/aws-alb-502-02.png 680w,
/static/daac7aea50ae49e2b704c1a5fa2a658b/02d09/aws-alb-502-02.png 1020w,
/static/daac7aea50ae49e2b704c1a5fa2a658b/68934/aws-alb-502-02.png 1278w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;/figure&gt;
&lt;p&gt;이렇게 502 Bad Gateway를 반환하고 있었습니다.&lt;/p&gt;
&lt;p&gt;음.. 당연히 비즈니스 로직 상의 Spring Boot 서버가 502를 반환할 리는 없고.. 그렇다고 EC2에서 반환할 리가 없을 것 같은데.. 다른 인프라가 있나? 라고 생각한 순간 머리 속을 스쳐간 것이 AWS의 ALB입니다. 이전에 도메인을 연결하면서 ALB를 설정했었는데 거기서 잘못됐나보다라고 생각하게 됐습니다.&lt;/p&gt;
&lt;p&gt;AWS에서 ALB 모니터링을 보니 502를 반환하고 있던 것을 확인했습니다.&lt;/p&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 371px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/7b3ed11bba5f445bbc5030a9e243cdd2/d86da/aws-alb-502-03.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 80%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsTAAALEwEAmpwYAAABRElEQVR42q1T7W6DMAzk/Z9pj9FOqNB2fLXwI7A1AZyEpLuQ9GOr1jFpJxES2eezHScaibK82O3fquqQZTljrTFm+gEwSSnzohwBoghrkmyLstzt9qvVGuv5KZTSyXZPhCAy0lpbaxHy/EcopSJ8x2PdNI294Fea93FkKGMnhIC4XQalpy9kNGOR5ry2Qk7Gan0hL8S/klEqEd037AnMXBrjFMi+WlT/2M/HLgTl/iFtGIwNhFG51o8qdNFcovjfTdmTMSWYvY9BCtLee5BueMBHvM5JmTmQ1ZN572W4KqTtMmlbN2+Shr7HwMKgtMJ5HAZ0BCKAO7qJJq93u2efHsxxHHdd55OEKU1Txpg/grnZbCBzG09PfnlttllVlUVd14eqQhTvYUK2Afez5MjwQ72MjycuOOdiBgzXR/jtTV63J84/AccDq6tbSJqAAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;aws alb 502 03&apos; title=&apos;&apos; src=&apos;/static/7b3ed11bba5f445bbc5030a9e243cdd2/d86da/aws-alb-502-03.png&apos; srcset=&apos;/static/7b3ed11bba5f445bbc5030a9e243cdd2/e7570/aws-alb-502-03.png 170w,
/static/7b3ed11bba5f445bbc5030a9e243cdd2/f46e7/aws-alb-502-03.png 340w,
/static/7b3ed11bba5f445bbc5030a9e243cdd2/d86da/aws-alb-502-03.png 371w&apos; sizes=&apos;(max-width: 371px) 100vw, 371px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption&gt;ALB 모니터링&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2&gt;문제 알아보기&lt;/h2&gt;
&lt;p&gt;구글에 AWS ALB가 502를 반환하는 경우를 검색해보았는데, 꽤나 많은 자료들이 있었습니다.&lt;/p&gt;
&lt;p&gt;우선, ALB의 로그를 확인해보기로 했습니다. 로그 확인 방법은 아래의 블로그를 참고하여 진행했습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.aws.amazon.com/ko_kr/athena/latest/ug/application-load-balancer-logs.html&quot;&gt;https://docs.aws.amazon.com/ko_kr/athena/latest/ug/application-load-balancer-logs.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://inpa.tistory.com/entry/AWS-%F0%9F%93%9A-ELBALB-%EB%A1%9C%EA%B7%B8-%ED%99%9C%EC%84%B1%ED%99%94-S3%EC%97%90-%EB%A1%9C%EA%B7%B8-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0&quot;&gt;https://inpa.tistory.com/entry/AWS-%F0%9F%93%9A-ELBALB-%EB%A1%9C%EA%B7%B8-%ED%99%9C%EC%84%B1%ED%99%94-S3%EC%97%90-%EB%A1%9C%EA%B7%B8-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://velog.io/@jiyeon_hong/AWS-Athena%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-ALB-Access-Log-%EB%B6%84%EC%84%9D-%EB%B0%A9%EB%B2%95&quot;&gt;https://velog.io/@jiyeon_hong/AWS-Athena%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-ALB-Access-Log-%EB%B6%84%EC%84%9D-%EB%B0%A9%EB%B2%95&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://metaverse-cloud.tistory.com/264&quot;&gt;https://metaverse-cloud.tistory.com/264&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;생성된 로그에서 status code가 502인 경우들을 모두 검색했습니다.&lt;/p&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/1adbccfa8a80b99ad25fbbd775590a5d/bbbf7/aws-alb-502-04.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 19.411764705882355%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAARklEQVR42pWOUQrAIAxDe/9LCvMAtbqYzq+Vfcm+6iMQCAlEylVH76rarJkZALpnNACJAcn5EeaMPItEd208J8id/vnTJF8fuOe9yzIKNwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;aws alb 502 04&apos; title=&apos;&apos; src=&apos;/static/1adbccfa8a80b99ad25fbbd775590a5d/ca1dc/aws-alb-502-04.png&apos; srcset=&apos;/static/1adbccfa8a80b99ad25fbbd775590a5d/e7570/aws-alb-502-04.png 170w,
/static/1adbccfa8a80b99ad25fbbd775590a5d/f46e7/aws-alb-502-04.png 340w,
/static/1adbccfa8a80b99ad25fbbd775590a5d/ca1dc/aws-alb-502-04.png 680w,
/static/1adbccfa8a80b99ad25fbbd775590a5d/02d09/aws-alb-502-04.png 1020w,
/static/1adbccfa8a80b99ad25fbbd775590a5d/bbbf7/aws-alb-502-04.png 1280w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption&gt;status_code가 502인 경우 검색&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/1c8ea721157aa36edc9e8d078221905f/bbbf7/aws-alb-502-05.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 58.235294117647065%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABeElEQVR42oWS2ZajMAxE+f9v7HnoOR2CN7Ax2HiB9LWzPM7oKEEiLlWpnEEuaos+pP2/6aO3frGbJd1mjTXDss4+rOvu/M73K/djaxnf+Wq9D55jalZCi1HeBwdqD8eRYoghxOM4QozbtvOSz77xoAC0kdSr8yEEa904iSGlbOZZCGmtlVLdbqPWZl4IyyAeYEopMcZaK29SSrQ559X7gYqjkxBP8M/PTRvN4HX1/OScg/Y6T04/Ho9cynnRnbVUxA2lVkga2DmpYL4ZM1MTbTwOhAAgfcDnRYuKLYTOPC/TBLN7MWtDDR6AcyuLQ4XaBs757FFLacw5JyHl9/dfrTTIr68/43hXWiulYzxQgX5Osy1gRtQeTOngUowxAPDmfp+YIqTCBRJzFi4V5o/snGsjvspHNjDcZknVdh6Z1Vd28LSdn7Lf4Lfsblhthi3vq5J95+Y2LeB/7MzfY8DMZvI4ctvsOVKYGVrbmZ9gCKiv62qye5QO/gXJOq3GBXAaxAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;aws alb 502 05&apos; title=&apos;&apos; src=&apos;/static/1c8ea721157aa36edc9e8d078221905f/ca1dc/aws-alb-502-05.png&apos; srcset=&apos;/static/1c8ea721157aa36edc9e8d078221905f/e7570/aws-alb-502-05.png 170w,
/static/1c8ea721157aa36edc9e8d078221905f/f46e7/aws-alb-502-05.png 340w,
/static/1c8ea721157aa36edc9e8d078221905f/ca1dc/aws-alb-502-05.png 680w,
/static/1c8ea721157aa36edc9e8d078221905f/02d09/aws-alb-502-05.png 1020w,
/static/1c8ea721157aa36edc9e8d078221905f/bbbf7/aws-alb-502-05.png 1280w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption&gt;검색 결과&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;여기서 request_processing_time, target_processing_time, response_processing_time 모두 -1인 것을 확인할 수 있습니다. AWS 문서에서는 이 경우에 대한 원인을 알려주고 있었습니다.&lt;/p&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/c01b6487eaac26f7b1e728b6ed457f6f/bbbf7/aws-alb-502-06.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 18.823529411764707%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAt0lEQVR42m1PWw6DMAzj/idkrPQJbONVoGxqi4TXFsTPFsmKk1iJk3GhwIREzJRJCFklLmQd+ipxxiVIycNcgPJDY9YV/yIbRo226xO6fsCr7S7eDyPmecE0zZgXA2NWjEEf+fr+YN/334U8XIuXC0KRFyUI5chvJNX3kqFungnWOnjv4ZyHD7DWwp11zH7bYJ1DJlUNVTXXa8e7Ki2p6gem4FDr02F4czndLcakng7uoybOtJ7wBT1SLe7i5fSTAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;aws alb 502 06&apos; title=&apos;&apos; src=&apos;/static/c01b6487eaac26f7b1e728b6ed457f6f/ca1dc/aws-alb-502-06.png&apos; srcset=&apos;/static/c01b6487eaac26f7b1e728b6ed457f6f/e7570/aws-alb-502-06.png 170w,
/static/c01b6487eaac26f7b1e728b6ed457f6f/f46e7/aws-alb-502-06.png 340w,
/static/c01b6487eaac26f7b1e728b6ed457f6f/ca1dc/aws-alb-502-06.png 680w,
/static/c01b6487eaac26f7b1e728b6ed457f6f/02d09/aws-alb-502-06.png 1020w,
/static/c01b6487eaac26f7b1e728b6ed457f6f/bbbf7/aws-alb-502-06.png 1280w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption&gt;출처: https://repost.aws/ko/knowledge-center/elb-alb-troubleshoot-502-errors&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/bd1a1b4b3d21f0430eff8188ae13b4f9/bbbf7/aws-alb-502-07.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA50lEQVR42j2NyU7DQBBE/f//gbhxgIA4IU6IQxKOSBHxvsx4G28Q27F5tG2Jlp6qqrunxwqjhCCMV3w/xHF8HHchwPUCPOnZks+Ox9l21xzImzwvMVVNVTfUwuXnwlJW1bSEsZYlhS8Ekd40VkRJ+j+r6pam/aZuOtq2E98xjCPzPDFNs+jvdrBMEwoVU2j5VTQX3XxEGodkSbTmMlMsu2Uqx41hvE4Mw0jf9/Tjld5oBnXCCt/ucF5u8F5vKQ47zMcz5vgo7Cj395jDA+XxaZ0Ve/Gi2v9CZQVaZyidEuscbX9Sn975A3uKJ6K7wc0ZAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;aws alb 502 07&apos; title=&apos;&apos; src=&apos;/static/bd1a1b4b3d21f0430eff8188ae13b4f9/ca1dc/aws-alb-502-07.png&apos; srcset=&apos;/static/bd1a1b4b3d21f0430eff8188ae13b4f9/e7570/aws-alb-502-07.png 170w,
/static/bd1a1b4b3d21f0430eff8188ae13b4f9/f46e7/aws-alb-502-07.png 340w,
/static/bd1a1b4b3d21f0430eff8188ae13b4f9/ca1dc/aws-alb-502-07.png 680w,
/static/bd1a1b4b3d21f0430eff8188ae13b4f9/02d09/aws-alb-502-07.png 1020w,
/static/bd1a1b4b3d21f0430eff8188ae13b4f9/bbbf7/aws-alb-502-07.png 1280w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption&gt;영문이 좀 더 명시적으로 해결해주는 듯하다.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&quot;&lt;em&gt;대상의 연결 유지 제한 시간이 로드 밸런서의 유휴 제한 시간보다 짧을 때 발생합니다.&lt;/em&gt;&quot;라고 나와 있습니다.&lt;/p&gt;
&lt;h3&gt;HTTP 502 상태 코드란?&lt;/h3&gt;
&lt;p&gt;RFC 7231 문서에서는 다음과 같이 설명하고 있습니다.&lt;/p&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/79128aaad47d850bfc18f2195875f8c9/39eee/aws-alb-502-08.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 16.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAkUlEQVR42l2M2w6CMBiDeRSNEs+JIscNxmSDcRCI+v7PUvPPjAsvmjZf2nrHqIJ/iXGLMvBSIc0lmKgQxAyr7R5r/7D4v4g7OeZtdidEWWGPwjRHwksUj9oyOiVGTpw6LsdMLDvHztfwd6jMgG58IZcaTT+h7kZI3Vp3WbdPDPPHZuqXysAMs5WoGvTTG/eE4wsR7GNbbRzgxQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;aws alb 502 08&apos; title=&apos;&apos; src=&apos;/static/79128aaad47d850bfc18f2195875f8c9/ca1dc/aws-alb-502-08.png&apos; srcset=&apos;/static/79128aaad47d850bfc18f2195875f8c9/e7570/aws-alb-502-08.png 170w,
/static/79128aaad47d850bfc18f2195875f8c9/f46e7/aws-alb-502-08.png 340w,
/static/79128aaad47d850bfc18f2195875f8c9/ca1dc/aws-alb-502-08.png 680w,
/static/79128aaad47d850bfc18f2195875f8c9/39eee/aws-alb-502-08.png 688w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption&gt;출처: https://datatracker.ietf.org/doc/html/rfc7231#section-6.6.3&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;게이트웨이나 프록시 서버에서 백엔드 서버로 응답을 요청했는데, 유효하지 않은 응답을 받은 경우 반환한다고 합니다. 우리 같은 경우는 ALB에서 Spring 서버로 요청을 했는데, Spring 서버에서 유효하지 않은 응답을 보내온 경우로 볼 수 있습니다.&lt;/p&gt;
&lt;h3&gt;keep-alive?&lt;/h3&gt;
&lt;figure&gt;
    &lt;img src=&apos;/static/aws-alb-502-09-ff4c48a9edfa332edc0c65bd3079f41a.svg&apos;&gt;
    &lt;figcaption&gt;출처: https://ko.wikipedia.org/wiki/HTTP_%EC%A7%80%EC%86%8D%EC%A0%81_%EC%97%B0%EA%B2%B0_%EC%83%81%ED%83%9C&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;HTTP 통신을 시작할 때 TCP의 3-way handshake를 진행합니다. HTTP 통신을 마무리할 때에는 4-way handshake를 진행합니다. 한 번의 HTTP 통신을 할 때마다 이 두 과정을 진행한다면 큰 overhead가 될 것입니다.&lt;/p&gt;
&lt;p&gt;이런 낭비를 방지하기 위해 한 번 TCP Connection을 맺으면 여러 번 데이터를 주고 받게 할 수 있습니다. 이것이 HTTP Keep-Alive입니다.&lt;/p&gt;
&lt;p&gt;(참고) http/1.0에서는 이 기능을 사용하기 위해서는 HTTP Header에 해당 설정을 명시해주어야 했지만, http/1.1부터는 굳이 명시하지 않아도 connection을 유지합니다.(기본으로 keep-alive가 설정되어있습니다.)&lt;/p&gt;
&lt;h3&gt;connectionTimeout vs. keepAliveTimeout&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;connectionTimeout : Client와 Server 간에 연결하는데 소요되는 최대 시간을 의미합니다. 즉, TCP 3-way handshake로 연결이 완료되기까지의 최대 시간이라 할 수 있습니다. 만약, 설정된 시간 내에 연결이 되지 않으면 timeout이 발생하게 됩니다.&lt;/li&gt;
&lt;li&gt;keepAliveTimeout : 통신 없이 IDLE 상태로 연결을 유지하는 시간으로, 다른 요청을 받기까지 기다리는 최대 시간을 의미합니다. 가장 최근에 받은 요청에서 설정된 시간 내에 다른 요청을 받지 않으면 연결을 끊게 됩니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;그럼 왜 발생했을까?&lt;/h3&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/5dd8d4076c1c5a5dc5800f31ac16be64/6176d/aws-alb-502-10.webp&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 92.3529411764706%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/webp;base64,UklGRkgAAABXRUJQVlA4IDwAAADQAgCdASoUABIAPtFgqU+oJaOiKAgBABoJaQAAPaOgAP7xvNcALbaa2sFbM/VlBqhlRi55q3wsREqwAAA=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;aws alb 502 10&apos; title=&apos;&apos; src=&apos;/static/5dd8d4076c1c5a5dc5800f31ac16be64/4c79d/aws-alb-502-10.webp&apos; srcset=&apos;/static/5dd8d4076c1c5a5dc5800f31ac16be64/33073/aws-alb-502-10.webp 170w,
/static/5dd8d4076c1c5a5dc5800f31ac16be64/719ab/aws-alb-502-10.webp 340w,
/static/5dd8d4076c1c5a5dc5800f31ac16be64/4c79d/aws-alb-502-10.webp 680w,
/static/5dd8d4076c1c5a5dc5800f31ac16be64/b36b9/aws-alb-502-10.webp 1020w,
/static/5dd8d4076c1c5a5dc5800f31ac16be64/8717b/aws-alb-502-10.webp 1360w,
/static/5dd8d4076c1c5a5dc5800f31ac16be64/6176d/aws-alb-502-10.webp 1463w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption&gt;출처: https://www.tessian.com/blog/how-to-fix-http-502-errors/&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;AWS 문서에도 나왔다시피 Server에서 먼저 connection을 닫아버려서 그렇습니다. ALB에서는 아직 보낼 데이터가 있는데 Server에서 HTTP 연결을 마무리하는 FIN을 보내고 연결을 끝냈습니다. 닫힌 소켓에 대해 응답을 받을 수 없으니 Client에게는 502 상태 코드를 보내게 됩니다.&lt;/p&gt;
&lt;h3&gt;request_processing_time, target_processing_time, response_processing_time&lt;/h3&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/ebc9e38839cf32fb290f84077bd262ab/6b1ac/aws-alb-502-11.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 75.29411764705883%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACHklEQVR42m2TiZKiQAyGff8HXA9AAQGRWwTUQc3kC7CztaNVqXS3dPo/ktX1epWiKqUsK2nbq/TDIH4QSBgeJY4Sy4eDL1EUS1XVcrm0FnXN+iKNRt1chDrP51NW7/db/v3dHw85Z5kURSF5XkiW5RZ5nlvBum6k0mJFWeq+sjPAUJBaq9frZYulcN8Psts5st8fxPcDcV3P9p63l+12Jxtis5Wtni15vd7I8Rh9Rth1nV105kJWTIu7nid7pX5U6kEYShTHVoRgnSmrCeF/BW93pXzOJFOK5FKpQT1Nz0btdrvJoDqjNY9DlTyOo8B21WKKXipVj7pp9OObBEGoKI5mBNm3fagShIYWpK5KkCQnOZ1SiePEtH0tGi6hSqqGvenkOK5dMlpRZJeTJLGM8yBuFACFGnUZ17n7S8PH15c6XBpqPuq63oyCKjSNru4H3UN3oXy/3yfKv0zRV3DOdSd0IILSkjGASE6J7RfKoOS3ou94DQS8Aopg1owPMQKD0jRVk85/DUttPe2hD0pDSIFL29qUcIhJtA36gfSP9tqiKZkz/t/p3vK8X+t3SPRxUjKbisraBT1ByXQsU0HmnGznGnVTy6j6T5OihX4mpbepACEtsjQ3jQ66neMYOs7QmBGFNnNtjf3JFMaNXkND0GbzbJMJCuRFMc/4VBCpzBSa0RDOAeWftmnMLNO2pUV0MnTNo1PLTOcUG8enNfY3kp5s+Y8mmW0AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;aws alb 502 11&apos; title=&apos;&apos; src=&apos;/static/ebc9e38839cf32fb290f84077bd262ab/ca1dc/aws-alb-502-11.png&apos; srcset=&apos;/static/ebc9e38839cf32fb290f84077bd262ab/e7570/aws-alb-502-11.png 170w,
/static/ebc9e38839cf32fb290f84077bd262ab/f46e7/aws-alb-502-11.png 340w,
/static/ebc9e38839cf32fb290f84077bd262ab/ca1dc/aws-alb-502-11.png 680w,
/static/ebc9e38839cf32fb290f84077bd262ab/02d09/aws-alb-502-11.png 1020w,
/static/ebc9e38839cf32fb290f84077bd262ab/6b1ac/aws-alb-502-11.png 1065w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption&gt;출처: https://docs.aws.amazon.com/ko_kr/elasticloadbalancing/latest/classic/access-log-collection.html#access-log-entry-format&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;request_processing_time : ALB가 클라이언트에게서 요청을 받고, 연결된 인스턴스(EC2)에 요청하기까지 걸린 시간
-1인 경우는 연결된 인스턴스가 유휴 시간 초과 이전에 연결을 닫은 경우일 수 있다고 합니다.&lt;/li&gt;
&lt;li&gt;target_processing_time : ALB가 연결된 인스턴스에 요청을 하고, 응답을 받기까지 걸린 시간
-1인 경우는 역시 연결된 인스턴스가 유휴 시간 초과 이전에 연결을 닫은 경우일 수 있다고 합니다.&lt;/li&gt;
&lt;li&gt;response_processing_time : ALB가 연결된 인스턴스에게 응답을 받고, 클라이언트에게 응답하기까지 걸린 시간
-1인 경우는 역시역시 연결된 인스턴스가 유휴 시간 초과 이전에 연결을 닫은 경우일 수 있다고 합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;문제 해결하기&lt;/h2&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/02f915689fa56244f9c13ff7601127de/bbbf7/aws-alb-502-12.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 19.411764705882355%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAcUlEQVR42m2O2wrEIAxE/f8f3b70oSlszMVkTcBFbQcG9DBkpgCAq6qLSJqZ0+M/TEQr6xmq6Fzrn30RvQDcGR4ysyyYFSxKFqbieHxcznPJleuCfMyQiBcWitLW2oPZxPIg9pn7mreFwfYS7cdsy/0AjAY8KsXv3eMAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;aws alb 502 12&apos; title=&apos;&apos; src=&apos;/static/02f915689fa56244f9c13ff7601127de/ca1dc/aws-alb-502-12.png&apos; srcset=&apos;/static/02f915689fa56244f9c13ff7601127de/e7570/aws-alb-502-12.png 170w,
/static/02f915689fa56244f9c13ff7601127de/f46e7/aws-alb-502-12.png 340w,
/static/02f915689fa56244f9c13ff7601127de/ca1dc/aws-alb-502-12.png 680w,
/static/02f915689fa56244f9c13ff7601127de/02d09/aws-alb-502-12.png 1020w,
/static/02f915689fa56244f9c13ff7601127de/bbbf7/aws-alb-502-12.png 1280w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption&gt;Connection idle timeout : 60초&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;ALB의 유휴 제한 시간은 60초입니다.&lt;/p&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/5f747de72341965cbd87db050b90cae6/7644a/aws-alb-502-13.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 6.470588235294117%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAARklEQVR42j3MOw6AIBQFUfe/SS0UHh8FRDTBYtRXWJxMcos7pHywpUo7O/1Ga6x/BaxExmlWi/GIi7pZCT9xK9/HXi9yaTzygEtcwFoIOQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;aws alb 502 13&apos; title=&apos;&apos; src=&apos;/static/5f747de72341965cbd87db050b90cae6/ca1dc/aws-alb-502-13.png&apos; srcset=&apos;/static/5f747de72341965cbd87db050b90cae6/e7570/aws-alb-502-13.png 170w,
/static/5f747de72341965cbd87db050b90cae6/f46e7/aws-alb-502-13.png 340w,
/static/5f747de72341965cbd87db050b90cae6/ca1dc/aws-alb-502-13.png 680w,
/static/5f747de72341965cbd87db050b90cae6/02d09/aws-alb-502-13.png 1020w,
/static/5f747de72341965cbd87db050b90cae6/7644a/aws-alb-502-13.png 1233w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption&gt;기본값은 connectionTimeout 값과 같다.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/28b685e463c0be85e1c320ea0fe3ce83/89578/aws-alb-502-14.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 7.0588235294117645%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAATklEQVR42h2KSQqAMBAE/f/XFBeYGEMUwSySnPSix3LwUBRUd1Oc5bRCLS/XDTk/tJ1DTMDMEZFAP6zKxjjtGKttSbol/UR1+C1y4H3lA1/aR5Dqe7NzAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;aws alb 502 14&apos; title=&apos;&apos; src=&apos;/static/28b685e463c0be85e1c320ea0fe3ce83/ca1dc/aws-alb-502-14.png&apos; srcset=&apos;/static/28b685e463c0be85e1c320ea0fe3ce83/e7570/aws-alb-502-14.png 170w,
/static/28b685e463c0be85e1c320ea0fe3ce83/f46e7/aws-alb-502-14.png 340w,
/static/28b685e463c0be85e1c320ea0fe3ce83/ca1dc/aws-alb-502-14.png 680w,
/static/28b685e463c0be85e1c320ea0fe3ce83/02d09/aws-alb-502-14.png 1020w,
/static/28b685e463c0be85e1c320ea0fe3ce83/89578/aws-alb-502-14.png 1209w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption&gt;connectionTimeout의 기본값은 20초이다.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;이에 반해 Spring Boot의 연결 유지 제한 시간은 20초입니다.&lt;/p&gt;
&lt;p&gt;Spring Boot의 keep-alive-timeout을 70초(70000ms)로 늘려 최종적으로 해결했습니다.&lt;/p&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 274px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/01b0a625bc7a694cae04286f812062a9/64b85/aws-alb-502-15.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 37.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABKElEQVR42pVRSXLCMBD0UxwobPbFxrYkyyteCIEUVSEc4Qe55ZJz/t1pueCWiw9dPaOa6ekZWcM4gyobtNUe5a5FRR4XDWyZYCA0RpuwFyzXkxBRChlqBIEmJ3B9hZkvMCVGnoDTA9Z4K2EzCKME57xGm+zgihzXtsJbWcBehRzQQ9C4cXwJj+60zBBQ2Bcp1pHGdKu6IvcfPAVc9j7RCa5UAoeNPlf+yBsc0wonutzEJexNhME6xIA8fMT2IzexY3i5hT338LLweMMI1s/XCWMKmlvNyIXKkdCpGZAzNq4VHRvnJi9V0b3puMDE1BwveP28YX+5YS4yWL/fZ0yCGCNaXpJPaY1zVnfNOzYZtLqEoGhNNlscyDm3mPADVfOOw/VO0TsWMsMfboLl4ueYQ5QAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;aws alb 502 15&apos; title=&apos;&apos; src=&apos;/static/01b0a625bc7a694cae04286f812062a9/64b85/aws-alb-502-15.png&apos; srcset=&apos;/static/01b0a625bc7a694cae04286f812062a9/e7570/aws-alb-502-15.png 170w,
/static/01b0a625bc7a694cae04286f812062a9/64b85/aws-alb-502-15.png 274w&apos; sizes=&apos;(max-width: 274px) 100vw, 274px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption&gt;application.yml에 다음과 같이 설정한다.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2&gt;참고&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://velog.io/@haron/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-AWS-ALB%EC%9D%98-HTTP-502-%EC%98%A4%EB%A5%98%EB%A5%BC-%ED%95%B4%EA%B2%B0%ED%95%B4%EB%B3%B4%EC%9E%90-dba4dfrv&quot;&gt;https://velog.io/@haron/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-AWS-ALB%EC%9D%98-HTTP-502-%EC%98%A4%EB%A5%98%EB%A5%BC-%ED%95%B4%EA%B2%B0%ED%95%B4%EB%B3%B4%EC%9E%90-dba4dfrv&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://inpa.tistory.com/entry/AWS-%F0%9F%93%9A-ELBALB-%EB%A1%9C%EA%B7%B8-%ED%99%9C%EC%84%B1%ED%99%94-S3%EC%97%90-%EB%A1%9C%EA%B7%B8-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0&quot;&gt;https://inpa.tistory.com/entry/AWS-%F0%9F%93%9A-ELBALB-%EB%A1%9C%EA%B7%B8-%ED%99%9C%EC%84%B1%ED%99%94-S3%EC%97%90-%EB%A1%9C%EA%B7%B8-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.aws.amazon.com/ko_kr/athena/latest/ug/application-load-balancer-logs.html&quot;&gt;https://docs.aws.amazon.com/ko_kr/athena/latest/ug/application-load-balancer-logs.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.aws.amazon.com/elasticloadbalancing/latest/application/enable-access-logging.html&quot;&gt;https://docs.aws.amazon.com/elasticloadbalancing/latest/application/enable-access-logging.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://repost.aws/ko/knowledge-center/elb-alb-troubleshoot-502-errors&quot;&gt;https://repost.aws/ko/knowledge-center/elb-alb-troubleshoot-502-errors&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://velog.io/@jiyeon_hong/AWS-Athena%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-ALB-Access-Log-%EB%B6%84%EC%84%9D-%EB%B0%A9%EB%B2%95&quot;&gt;https://velog.io/@jiyeon_hong/AWS-Athena%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-ALB-Access-Log-%EB%B6%84%EC%84%9D-%EB%B0%A9%EB%B2%95&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://devocean.sk.com/blog/techBoardDetail.do?ID=165428&amp;#x26;boardType=techBlog&quot;&gt;https://devocean.sk.com/blog/techBoardDetail.do?ID=165428&amp;#x26;boardType=techBlog&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://metaverse-cloud.tistory.com/264&quot;&gt;https://metaverse-cloud.tistory.com/264&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://tomcat.apache.org/tomcat-8.5-doc/config/http.html&quot;&gt;https://tomcat.apache.org/tomcat-8.5-doc/config/http.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://velog.io/@haron/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-AWS-ALB%EC%9D%98-HTTP-502-%EC%98%A4%EB%A5%98%EB%A5%BC-%ED%95%B4%EA%B2%B0%ED%95%B4%EB%B3%B4%EC%9E%90-dba4dfrv&quot;&gt;https://velog.io/@haron/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-AWS-ALB%EC%9D%98-HTTP-502-%EC%98%A4%EB%A5%98%EB%A5%BC-%ED%95%B4%EA%B2%B0%ED%95%B4%EB%B3%B4%EC%9E%90-dba4dfrv&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.tessian.com/blog/how-to-fix-http-502-errors/&quot;&gt;https://www.tessian.com/blog/how-to-fix-http-502-errors/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://goodgid.github.io/HTTP-Keep-Alive/&quot;&gt;https://goodgid.github.io/HTTP-Keep-Alive/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[[Network] HTTP와 HTTPS]]></title><description><![CDATA[HTTP와 HTTPS HTTP(Hyper Text Transfer Protocol)는 서버/클라이언트 모델에 따라 데이터를 주고 받기 위한 프로토콜입니다. 즉, HTTP는 인터넷에서 하이퍼 텍스트를 교환하기 위한 통신 규약으로, 8…]]></description><link>https://modisfive.github.io/http-vs-https/</link><guid isPermaLink="false">https://modisfive.github.io/http-vs-https/</guid><pubDate>Tue, 26 Mar 2024 00:00:00 GMT</pubDate><content:encoded>&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/8d88887225da1f9346d842abd1f7699d/59f54/http-vs-https-01.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 17.64705882352941%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA0UlEQVR42mXO207DMAwG4L7/W3GBhBAINAYsNMuho2mObZjUNm0vfoxAk9AuPsV27MQVe3woL2xXnl73hTFeuJREXRNUP4rCal7e3lk5sPoK+6iXSt/e4Jnf426/g7Me0TqE1iCYDvGPpzx6j9T3sM5BKgUhFeiDf45CopLU7GzA6dRC1BxZaGRjkdvuF8VnuhukRsoZMUaklBDJOI6YpulinmdUTaPho0fTfkJxji8azsOAHBOGENHTA+efU2l0tKUxBj4EBKoty4J1XS+2bcM37YQl9PCuLbUAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;http vs https 01&apos; title=&apos;&apos; src=&apos;/static/8d88887225da1f9346d842abd1f7699d/ca1dc/http-vs-https-01.png&apos; srcset=&apos;/static/8d88887225da1f9346d842abd1f7699d/e7570/http-vs-https-01.png 170w,
/static/8d88887225da1f9346d842abd1f7699d/f46e7/http-vs-https-01.png 340w,
/static/8d88887225da1f9346d842abd1f7699d/ca1dc/http-vs-https-01.png 680w,
/static/8d88887225da1f9346d842abd1f7699d/59f54/http-vs-https-01.png 792w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption&gt;출처: https://www.cloudflare.com/ko-kr/learning/ssl/what-is-https/&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2&gt;HTTP와 HTTPS&lt;/h2&gt;
&lt;p&gt;HTTP(Hyper Text Transfer Protocol)는 서버/클라이언트 모델에 따라 데이터를 주고 받기 위한 프로토콜입니다. 즉, HTTP는 인터넷에서 하이퍼 텍스트를 교환하기 위한 통신 규약으로, 80번 포트를 사용하고 있습니다.&lt;/p&gt;
&lt;h3&gt;HTTP의 문제점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;HTTP는 평문 통신이기 때문에 도청이 가능하다.&lt;/li&gt;
&lt;li&gt;통신 상대를 확인하지 않기 때문에 위장이 가능하다.&lt;/li&gt;
&lt;li&gt;완전성(정확성)을 증명할 수 없기 때문에 조작이 가능하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;HTTPS(HTTP over SSL, HTTP over TLS, HTTP Secure)는 HTTP에 데이터 암호화가 추가된 프로토콜이고, HTTP와 달리 443번 포트를 사용합니다. HTTPS의 가장 큰 특징은 HTTP가 가지고 있던 보안 문제들을 해결한다는 것입니다. 즉, HTTPS는 &lt;strong&gt;암호화, 인증, 완전성 보장&lt;/strong&gt;을 지원합니다.&lt;/p&gt;
&lt;h2&gt;SSL과 TLS&lt;/h2&gt;
&lt;p&gt;넷스스케이프가 SSL(Secure Socket Layer)을 발명하고, 점차 폭넓게 사용되다가 표준화 기구인 IETF의 관리로 넘어가면서 TLS(Transport Layer Security)로 이름이 바뀌었습니다. TLS 1.0은 SSL 3.0을 계승합니다.&lt;br&gt;
물론 TLS가 발전하면서 차이점도 존재하지만, 동작 방식은 유사하니 이 글에서는 같은 의미로 말합니다.&lt;/p&gt;
&lt;h2&gt;대칭키 암호화와 비대칭키 암호화&lt;/h2&gt;
&lt;h3&gt;대칭키 암호화&lt;/h3&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/735838ae354b376e7c746868b4cbcd3e/c0214/http-vs-https-02.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 54.70588235294118%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABxUlEQVR42m1SW27aUBD1ihoJiRWwGiQipb/pPyuABfSjQUL5hCZIreqKFqkQ2yIEFbCNMfhV2/Xj+hITfCE51GpSkd6vufM6Z84M9/jqua47mUxkWTZNY7lcapo2m83m8/l2u0V0v98/Z3Kvi9M0jaIoIcQPIu93SGkSBEGSJLvd7ijzuBjtUbx5OIA0P9+9b0swNpsHvCzL/lO8//tgB3Fyf5/m9q1sfR9qMIAZEZrQ9VHyCzIay7Ofl58k3YkO3222Wq0s22F/2HaHyyu+7/6y/x2bA0lIoigKIYSxzAsIoSkCnudBM1VRHcfBN6Ybx/WR4Pu+qqrQD3S4MAyRJIriYDDodDpf+S9xFFFKRUHo9Xr9/g9RlD5cXFxfX0F81/Vy5XmeR1MujuPxeGzbdqvVKhaLJ29Ozs7enlYqH9vt4fDWMIxGo1EoFEqlUrlcPn93/q3bXSx0gIMah62ANqzpdFqtVuv1umOjqSNJkiAIo9FocHNTq9WazSYWBkaABZJpmjiHw8y6rq8Mw/P9XIZcD8TACB1JTJ5FPmjhe7gcaLlerzksdqEtAI4PwtA8PwZMrioKaAMNfsZY7g/DAH7LshhjTz8OUAU2xg4+AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;http vs https 02&apos; title=&apos;&apos; src=&apos;/static/735838ae354b376e7c746868b4cbcd3e/ca1dc/http-vs-https-02.png&apos; srcset=&apos;/static/735838ae354b376e7c746868b4cbcd3e/e7570/http-vs-https-02.png 170w,
/static/735838ae354b376e7c746868b4cbcd3e/f46e7/http-vs-https-02.png 340w,
/static/735838ae354b376e7c746868b4cbcd3e/ca1dc/http-vs-https-02.png 680w,
/static/735838ae354b376e7c746868b4cbcd3e/c0214/http-vs-https-02.png 796w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption&gt;출처: https://www.ssl2buy.com/wiki/symmetric-vs-asymmetric-encryption-what-are-differences&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;클라이언트와 서버가 동일한 키를 사용하여 암호화/복호화를 진행&lt;/li&gt;
&lt;li&gt;키가 노출되면 매우 위험하지만, 연산 속도가 빠름&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;그런데, 이 대칭키를 어떻게 양쪽이 공유를 할까요? 대칭키가 중간에 갈취 당한다면 큰 문제일 것입니다. 이러한 대칭키 암호화 방식의 한계로, 비대칭키 암호화 방식이 등장했습니다.&lt;/p&gt;
&lt;h3&gt;비대칭키(공개키) 암호화&lt;/h3&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/a4c7c0fc6770b337f41a2b8aadcb6e08/c0214/http-vs-https-03.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 54.70588235294118%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABzElEQVR42m1Sy27aQBT1HyEh8QV8DVIqseoikbrkC+ATChKLSpFoGtiElgipAdtJEKoAUz+wsWsbZsbxS3js5CSpojTprO77nHvuCPfv3m63W61Wi8XC0I3tdquqv/GWy2UYhsgWRfFSKbxvTtOUUkYpcX3bdnePNiGMBYfD4U3l22ZUxHGcZTxJo/bg08fmqWHT+4JjYpZl/2ku/r4c9l3IkjSBkSTJ7Wrw5UL2SQQ3uIvCKH5VXPyDzHm2+LW8lE49asAFVU3XdN2gLIA7utYHP6buH/v12gIQVFVVFCUIGOc5CdwoZkh4vgfZEHccBy4JYuwPAN/31+s1JMzzXCCEoEiSpMlk0u/3hxffoRCElURxPB5fXf2UJPlzu31+/s2yTNd1ITs6h8MhhgqMsfl8btt2r9erVCqlUqler384Ojr72ru5uTVNs9PplMvlarVaq9WOT44vRyNN0wHueZ5AKQVtWDhso9FotVqOjaGOLMuiKM5ms8l02mw2u93ufr8HI8ACybIssHjcWdf1jWl6vv8sw7MeyIERJgZPgr0oDC0Mw9hsNlEUCTispmoAh4M0jgklUIRfslYU0AYa4hxiPsUJ2SOOn8c5fwAjjk3czwOjDQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;http vs https 03&apos; title=&apos;&apos; src=&apos;/static/a4c7c0fc6770b337f41a2b8aadcb6e08/ca1dc/http-vs-https-03.png&apos; srcset=&apos;/static/a4c7c0fc6770b337f41a2b8aadcb6e08/e7570/http-vs-https-03.png 170w,
/static/a4c7c0fc6770b337f41a2b8aadcb6e08/f46e7/http-vs-https-03.png 340w,
/static/a4c7c0fc6770b337f41a2b8aadcb6e08/ca1dc/http-vs-https-03.png 680w,
/static/a4c7c0fc6770b337f41a2b8aadcb6e08/c0214/http-vs-https-03.png 796w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption&gt;출처: https://www.ssl2buy.com/wiki/symmetric-vs-asymmetric-encryption-what-are-differences&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;두 개의 키 중 하나로 암호화하면, 나머지 키로만 복호화가 가능
&lt;ul&gt;
&lt;li&gt;예를 들어 A 키와 B 키가 하나의 쌍이라면, A 키로 암호화를 하면 B 키로 복호화를 할 수 있고, B 키로 암호화를 하면 A 키로 복호화를 할 수 있다.&lt;/li&gt;
&lt;li&gt;둘 중 하나를 공개키라 하고, 다른 하나를 개인키로 정한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;클라이언트는 공개키를 가지고, 서버는 개인키를 가짐
&lt;ul&gt;
&lt;li&gt;공개키는 이름에서 알 수 있다시피 누구나 가질 수 있다. 대신, 개인키는 서버만 가지고 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;키가 노출되더라도 비교적 안전하지만, 연산 속도가 느림&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;우리가 네이버에서부터 정보를 받았을 때, 이게 진짜 네이버에서 왔는지 어떻게 알 수 있을까요?&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;네이버에서 우리에게 보내는 정보들은 그 일부가 네이버의 개인키로 암호화가 되어있다.&lt;/li&gt;
&lt;li&gt;네이버의 개인키로 암호화된 정보를 복호화할 수 있는 것은 우리가 가진 네이버의 공개키 뿐이다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;만약 우리가 가진 네이버의 공개키로 온전히 복호화를 할 수 있다면, 그것은 네이버에서 온 정보일 것이다.&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이 예시는 단순히 인증을 이해하기 위한 예시로, 비대칭키 암호화를 사용하면 이렇게 인증을 할 수 있다는 것만 확인합니다. 실제로 서버의 인증은 이후에 설명할 SSL 인증서를 통해 진행됩니다.&lt;/p&gt;
&lt;h2&gt;SSL 인증서&lt;/h2&gt;
&lt;p&gt;SSL 인증서는 클라이언트와 서버 간의 통신을 제3자가 보증해주는 전자화된 문서입니다. 클라이언트가 서버에 접속한 직후에 서버는 클라이언트에게 이 인증서 정보를 전달합니다. 클라이언트는 이 인증서가 신뢰할만한 것인지 검증 후에 그 다음 절차를 진행합니다.&lt;/p&gt;
&lt;p&gt;이 SSL 인증서를 통해 위에서 언급한 HTTP의 보안 문제를 해결합니다. 즉, SSL 인증서의 기능은 크게 다음과 같습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;클라이언트가 접속한 서버가 신뢰할 수 있는 서버임을 보장한다.&lt;/li&gt;
&lt;li&gt;SSL 통신에 사용할 공개키를 클라이언트에게 제공한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;CA(Certificate Authority)&lt;/h3&gt;
&lt;p&gt;앞서 말했듯, 인증서의 역할 중 하나는 클라이언트가 접속한 서버가 신뢰할 수 있는 서버임을 보장하는 것입니다. 그럼 누가 보증을 해줄까요? 이를 인증하는 공인된 민간 기업들이 있습니다. 이러한 기업들을 CA라 합니다. SSL을 통해서 암호화된 통신을 제공하려는 서비스는 CA를 통해 인증서를 구입해야 합니다.&lt;/p&gt;
&lt;h3&gt;SSL 인증서의 내용&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;서비스의 정보&lt;/strong&gt; (인증서를 발급한 CA, 서비스의 도메인 등등)
&lt;ul&gt;
&lt;li&gt;클라이언트가 접속한 서버가 클라이언트가 의도한 서버가 맞는지에 대한 내용&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;서버 측의 공개키&lt;/strong&gt; (공개키의 내용, 공개키의 암호화 방법)
&lt;ul&gt;
&lt;li&gt;서버와 통신할 때 사용할 공개키와 그 공개키의 암호화 방법&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;서비스의 도메인, 공개키와 같은 정보는 서비스가 CA로부터 인증서를 구입할 때 제출해야 합니다. 이 내용들은 CA에 의해서 암호화되는데, 이때 사용하는 암호화 방식이 공개키(비대칭키) 방식입니다. &lt;strong&gt;CA는 자신의 CA 개인키를 이용해서 서비스에서 제출한 인증서를 암호화하는 것입니다.&lt;/strong&gt; CA의 개인키는 절대로 유출되어서는 안됩니다. 그리고, 우리가 사용하는 브라우저에는 CA들의 목록과 그들의 공개키가 내장되어 있습니다.&lt;/p&gt;
&lt;h2&gt;SSL 인증서가 서비스를 보증하는 방법&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;웹 브라우저가 서버에 접속할 때 서버는 제일 먼저 클라이언트에게 인증서를 제공한다.&lt;/li&gt;
&lt;li&gt;브라우저는 이 인증서를 발급한 CA가 자신이 내장한 CA의 리스트에 있는지를 확인한다.&lt;/li&gt;
&lt;li&gt;확인 결과 서버에서 받은 인증서가 내장된 CA 리스트에 포함되어 있다면, 해당 CA의 공개키를 이용해서 인증서를 복호화한다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;CA의 공개키를 이용해서 인증서를 복호화 할 수 있다는 것은 이 인증서가 CA의 개인키에 의해서 암호화 된 것을 의미한다.&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;해당 CA의 개인키를 가지고 있는 CA는 해당 CA 밖에는 없기 때문에, 서버가 제공한 인증서가 CA에 의해서 올바르게 발급된 것이라는 것을 의미한다.&lt;/li&gt;
&lt;li&gt;즉, CA에 의해서 발급된 인증서라는 것은 접속한 사이트가 CA에 의해서 검토되었다는 것을 의미하고, CA의 검토를 통과했다는 것은 해당 서비스가 신뢰 할 수 있다는 것을 의미한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이렇게 해서 인증서가 서버의 신뢰성을 제공하는 방법을 알아봤습니다. 그런데 의문점이 남습니다. 인증서에 포함된 서버의 공개키는 어떤 용도에 사용될까요?&lt;/p&gt;
&lt;h2&gt;SSL의 동작 방법&lt;/h2&gt;
&lt;p&gt;비대칭키 암호화 방식만을 사용하면 컴퓨팅 파워가 많이 소모되기 때문에 SSL 인증서에서는 &lt;strong&gt;대칭키 방식과 비대칭키 방식 모두를 사용&lt;/strong&gt;하고 있습니다. 클라이언트와 서버가 주고 받는 실제 정보는 대칭키 방식으로 암호화하고, 이 대칭키를 비대칭키 방식으로 암호화하여 클라이언트와 서버가 공유합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;실제 데이터 : 대칭키 방식&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;대칭키 방식의 키 : 비대칭키 방식&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;컴퓨터와 컴퓨터가 네트워크를 통해 통신을 할 때 내부적으로 3단계를 거칩니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Handshake → 전송 → 세션 종료&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;이러한 과정에서 SSL이 어떻게 데이터를 암호화하여 전달하는지 알아봅시다.&lt;/p&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/b6c3265b63fd50ce949c3df89a6326d2/92fa7/http-vs-https-04.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 57.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB70lEQVR42lVRTW8TQQzd30q5c+APcAROHJA4wQFVIqUCwSkcAkpR06ZJ01aFhgbytd+zu2N7PLOz3aQtZUKERKwnz4w19rP9PP3PmLUQGMaZL6BQ2ugNi+I4SVO9GfbWaS6a56iwDDOb8EIa68LrH8boVOA0onGictKl2Ux279qWTJwEsD+IumOIyJT/sQAoP5STxJ1aMSte82lvYU1nkr84mL8+HD9rT1rffFFAKgmVAlKklGblqiOAVni3sDe1/X1V1tYws2eNnmR0OC36M3nkwyjMXFkglqTWyJBSoKyAwTTdOQ3en0wbJ/6xX9SV9VzD3Wn68uhno//jVW/cGfmEMgdwG3DIQAkg4e6FPJvLjxfY/J46fzyHJAo9Uy5F8GU4eHzWe355+mQ+bgESoSDM/iJXlBtGQDZZ7y7dXgS7t8l2lXfCSHhsrmo5uI4adfzhOt5RSZ/Ystseo1aFJsEkDIYgM+2/y7tbw88P4s69Onxj7I2n7a2Zvw2+bl22H4b794tfu0zSoK8xYpWzQgfNhOiaCCwMKxyWMMR8Np3NHXNlcWRFW8UHldiD9ALJLRhWoNzRMqYafZRCBU08f+T3nzpfRs0CVjo7zSo2S13WulwWcjWwm1NRtgZT4cjB6Zad2/gT+i0TNV0L2lR/ANh5UJE5gHSTAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;http vs https 04&apos; title=&apos;&apos; src=&apos;/static/b6c3265b63fd50ce949c3df89a6326d2/ca1dc/http-vs-https-04.png&apos; srcset=&apos;/static/b6c3265b63fd50ce949c3df89a6326d2/e7570/http-vs-https-04.png 170w,
/static/b6c3265b63fd50ce949c3df89a6326d2/f46e7/http-vs-https-04.png 340w,
/static/b6c3265b63fd50ce949c3df89a6326d2/ca1dc/http-vs-https-04.png 680w,
/static/b6c3265b63fd50ce949c3df89a6326d2/02d09/http-vs-https-04.png 1020w,
/static/b6c3265b63fd50ce949c3df89a6326d2/9d567/http-vs-https-04.png 1360w,
/static/b6c3265b63fd50ce949c3df89a6326d2/92fa7/http-vs-https-04.png 2918w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption&gt;SSL Handshake는 TCP 레이어의 3-way Handshake 이후에 진행된다.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;SSL Handshake&lt;/strong&gt;
&lt;ol&gt;
&lt;li&gt;Client Hello : 클라이언트가 서버에 접속한다. 그리고 클라이언트에서 서버에 다음과 같은 정보를 전달한다.
&lt;ul&gt;
&lt;li&gt;클라이언트에서 생성한 랜덤 데이터&lt;/li&gt;
&lt;li&gt;클라이언트가 지원하는 암호화 방식&lt;/li&gt;
&lt;li&gt;세션 아이디 : 이미 SSL Handshaking을 했다면 비용과 시간 절약을 위해 기존 세션을 재활용하는데 이를 위한 식별자(이 과정에서는 크게 중요하지 않다.)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Server Hello : 서버는 Client Hello에 대한 응답으로 Server Hello 과정을 거치고, 클라이언트에 다음과 같은 정보를 전달한다.
&lt;ul&gt;
&lt;li&gt;서버에서 생성한 랜덤 데이터&lt;/li&gt;
&lt;li&gt;서버가 지원하는 암호화 방식&lt;/li&gt;
&lt;li&gt;인증서&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;클라이언트는 서버에게서 받은 인증서가 CA가 발급한 것인지를 확인하기 위해 클라이언트에 내장된 CA 리스트를 확인한다.&lt;br&gt;
만약, 그 리스트에 인증서가 없다면 사용자에게 경고 메시지를 출력한다. 인증서가 CA에 의해서 발급된 것인지 확인하기 위해 내장된 CA의 공개키로 복호화를 시도한다. 만약, 복호화에 성공하면 CA의 개인키로 암호화된 것이기 때문에 신뢰할 수 있다.&lt;br&gt;
클라이언트는 자신이 생성한 랜덤 데이터와 서버에서 받은 랜덤 데이터를 조합하여 pre master secret이라는 키를 생성한다. 이 pre master secret이라는 키를 서버에도 전달해줘야 하는데, 이 때 &lt;strong&gt;공개키 방식&lt;/strong&gt;으로 암호화를 한다.&lt;br&gt;
복호화된 인증서 안에는 서버가 생성한 공개키가 들어있다고 했었다. 클라이언트는 성공적으로 인증서를 복호화하면 서버 측에서 만든 공개키를 획득하게 된다. 클라이언트는 인증서에서 얻는 서버의 공개키로 pre master secret 값을 암호화하고 서버에 전달한다.&lt;/li&gt;
&lt;li&gt;서버는 그 공개키에 대한 개인키를 가지고 있기 때문에 pre master secret 값을 얻어낼 수 있다. 이제 클라이언트와 서버 모두 pre master secret 값을 공유하게 되었다. 클라이언트와 서버는 각각 일련의 과정을 통해 pre master secret에서 master secret 값을 만들어내고, 이 master secret으로 세션키를 생성한다. 이 세션키를 이용해서 서버와 클라이언트는 실제 데이터를 &lt;strong&gt;대칭키 방식&lt;/strong&gt;으로 암호화하여 주고 받는다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;전송(세션)&lt;/strong&gt;&lt;br&gt;
실제로 클라이언트와 서버가 데이터를 주고 받는 단계이다. 이전 단계에서 얻은 세션키를 이용하여 대칭키 방식으로 데이터를 암호화하고 상대방에게 전달한다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;세션 종료&lt;/strong&gt;&lt;br&gt;
데이터 전송이 끝나면 서로에게 SSL 통신이 끝났음을 알린다. 이 때 통신에서 사용한 대칭키인 세션키를 폐기한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;참고 자료&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=H6lpFRpyl14&quot;&gt;https://www.youtube.com/watch?v=H6lpFRpyl14&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=0cfUVrQW_yg&amp;#x26;list=PLCZ-8rvakaqbplQZAoUku8uuxUgbLQm-1&quot;&gt;https://www.youtube.com/watch?v=0cfUVrQW_yg&amp;#x26;list=PLCZ-8rvakaqbplQZAoUku8uuxUgbLQm-1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://opentutorials.org/course/228/4894&quot;&gt;https://opentutorials.org/course/228/4894&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://ko.gadget-info.com/difference-between-ssl&quot;&gt;https://ko.gadget-info.com/difference-between-ssl&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[whileTrue 프로젝트 후기]]></title><description><![CDATA[프로젝트 시작 계기 2023년 SSAFY를 다니면서 3번의 프로젝트를 진행했고, 2024년이 되면서 프로젝트보다는 알고리즘 문제 풀이나 CS…]]></description><link>https://modisfive.github.io/whiletrue-review/</link><guid isPermaLink="false">https://modisfive.github.io/whiletrue-review/</guid><pubDate>Thu, 14 Mar 2024 00:00:00 GMT</pubDate><content:encoded>&lt;div align=&apos;center&apos;&gt;
   &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 128px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/f7f917664e3534ff21383e4479b0de2c/82763/whileTrue_icon.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADm0lEQVR42n1USUgcQRR1FBU8KO4oGBS3Q9xNRFAPwfWioHG5GTfwICqIBNwvggsB0UtUjCAGQY1j4gouhBwUIwRRCLgcRMzBBRc0Gme6pl/+L6bHiBMLXtfv7qpXv169+jY21AC4El4RXhPKCG8JbYR+wgThK2GL8IvwhyAIiwaDIdI8345ga2N+eU44ODs7w+bmprqysoK5uTmMjIygu7sb9fX1KCsrQ3Z2NtLT05GUlISYmBi1r6+PpuGGUE00Oup1kpQe7xcXF2Fvb69ERkaaYmNjRWJiopKZmWksLCxUqqqqREtLi+jp6TENDw+r8/PzmJmZQXx8vKAFTDc3zInZ8/PzZ1qG+ra2NlCodHR08E+oqor/Ne2fyWRCRUWF6uHhoSwvL/OnI6PR+FISMhERCubPzc3F0NAQOjs7UVdXh/LycuTn5yMjIwMJCQmIiIhAYGAg/P39ERISwjvjuYapqSkm/ciEk+YMhYODA/fw8fFBeHg44uLikJqaipycHBQVFaG6uhrNzc3o6urC4OAgxsfHsbW1hbCwMMHfmesBIZO5ubnh4ODAsq2nmqIosk9LS1MaGxs5/PyIkDTByckJyBLY2NiQPU+8u7uTsfbO/e3trSRMSUnRCL88InR1dQWf3PT0tNz+7u7uf7PVMiRZnibklVkvZ2dnmRm39fV1JCcnY2lpCaWlpSBbYWdnx5JhQ0ODdUJPT08cHx8jKCgIBQUFMgs+aTs7O4mFhQXweFtbWzg6OmJgYOBpQj8/P5kFxxMTE/K2cFxSUiKl0Hy4v7+P4OBgeHl5sSuU1tbWe8L29nYLIQ9iC3DMmTK5k5OTPCyedHl5KRdiL/IYlob8qTQ1NVkI9f9mGBAQgOjoaERFRT3IhrfP//v7+6V+7u7umJyctKphr16vl1dPMzVrVVNTIwfTdbIQ7+3t4fr6GnRvZabadzqsB6ecIIQw0kVXiVD19fUFF4ujoyM5gQkZmkWs2Ybm3hvbXCDqLy4u4O3trbi4uEjtrHmP39nQV1dXOD09xeHhoURoaChXJMvV05lJx1dXV6HT6YysV2VlJfLy8ky0uiDRBZU2QVZSSBJB/hQkC2suaDz3htnZWSb8YCHc3t72oPjn2NgYW8dEF15Wl6ysLBQXF6O2tlb6r7e3F6Ojo9KPa2trXBxUlofLF+GFtmVZvknwMIq/m3f4mw+Y8IPwjTBP+EQYILwjsE+qCG8ImQRfJvsLM9A1CNc+AFMAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;whileTrue icon&apos; title=&apos;&apos; src=&apos;/static/f7f917664e3534ff21383e4479b0de2c/82763/whileTrue_icon.png&apos; srcset=&apos;/static/f7f917664e3534ff21383e4479b0de2c/82763/whileTrue_icon.png 128w&apos; sizes=&apos;(max-width: 128px) 100vw, 128px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;/div&gt;
&lt;h2&gt;프로젝트 시작 계기&lt;/h2&gt;
&lt;p&gt;2023년 SSAFY를 다니면서 3번의 프로젝트를 진행했고, 2024년이 되면서 프로젝트보다는 알고리즘 문제 풀이나 CS 공부를 중심적으로 해야겠다고 생각했습니다. 포트폴리오에 쓸 프로젝트는 완성되었으니 실질적인 취업 준비를 하려고 했습니다.&lt;/p&gt;
&lt;p&gt;어떻게 하면 좋은 포트폴리오를 작성하고 취업을 잘할 수 있을까 고민하던 중, 블로그 제목에 끌려 이동욱 님의 글 하나를 보게 되었습니다. (&lt;a href=&quot;https://jojoldu.tistory.com/763&quot;&gt;https://jojoldu.tistory.com/763&lt;/a&gt;) 본인에게 필요한 것을 만들어보고 실제 출시도 해보면서 배운 점을 정리하는 것이 곧 포트폴리오가 된다는 내용이었습니다. 이 글을 보고 프로젝트를 배척했던 마음을 접고, 그럼 나한테 필요한 서비스가 뭐가 있을까 생각했습니다.&lt;/p&gt;
&lt;p&gt;저는 알고리즘 문제를 풀 때, 다시 풀어보고 싶은 문제를 노션에 기록하고 있었습니다. 하지만, 문제 제목, 번호, URL 등등을 하나하나 직접 옮겨 적으려니 불편한 점들이 많았습니다. 또한, 저장된 문제들을 다시 풀고자 했을 때, 문제를 랜덤으로 뽑아줬으면 좋겠다고 생각했었습니다. 이 점을 개선하고자 whileTrue 프로젝트를 시작하게 되었습니다.&lt;/p&gt;
&lt;h2&gt;시작하기 전, 고민한 부분&lt;/h2&gt;
&lt;h3&gt;자바스크립트 vs. 타입스크립트&lt;/h3&gt;
&lt;p&gt;확장 프로그램의 개발 언어를 선택해야 했습니다. 자바스크립트로 진행할 경우, 이전에 사용해 본 경험이 있기 때문에 개발 진행이 상대적으로 더 빠를 것이라 생각되었습니다.&lt;/p&gt;
&lt;p&gt;그에 반해 타입스크립트로 진행하면 사용해 본 경험이 없기에 프로젝트 진행이 늦어질 것 같았습니다. 하지만 SSAFY 프로젝트의 프론트엔드 팀원들이 모두 타입스크립트를 사용하면서 궁금하기도 했고, 한번 경험해보고 싶다고 생각했기에 타입스크립트를 선택하게 되었습니다.&lt;/p&gt;
&lt;h3&gt;리액트를 사용할 것인가?&lt;/h3&gt;
&lt;p&gt;굳이 리액트를 사용하지 않고도 확장 프로그램을 개발할 수 있습니다. 리액트 역시 경험이 없기 때문에 선택하는 데에 고민이 되었습니다.&lt;/p&gt;
&lt;p&gt;리액트를 선택하면 다음과 같은 이점이 있었기에 고민이 되었고 결국 리액트를 선택하게 되었습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;보일러 플레이트가 있다.&lt;/p&gt;
&lt;p&gt;구글이나 GitHub에 검색하시면 크롬 확장 프로그램 개발을 위한 리액트 보일러 플레이트를 여럿 보실 수 있습니다. 이를 활용하여 확장 프로그램 구조 조금 더 쉽게 파악을 할 수 있었고 코드 관리를 더 잘할 수 있을 것 같았습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;화면 디자인이 더 수월하지 않을까? (추측)&lt;/p&gt;
&lt;p&gt;아무래도 리액트는 프론트엔드 라이브러리다 보니 화면을 디자인하고 다루는데 더 수월할 것 같다는 생각했습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;한번 해볼까?&lt;/p&gt;
&lt;p&gt;SSAFY에서 진행한 3번의 프로젝트 모두 자바 스프링 백엔드 역할을 맡았습니다. 리액트를 사용해 본 적이 없었기에 이번 기회에 한번 써보고자 했습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;어떤 데이터베이스를 사용할 것인가?&lt;/h3&gt;
&lt;p&gt;처음에는 노션 데이터베이스를 활용하고자 했으나 진행하면서 꼭 노션이어야 하는 의문이 들었습니다. 노션 API를 다루기도 쉽지 않았고, 다시 풀고 싶은 문제를 저장하고 랜덤으로 추출하는 것이 중요하지 노션이어야 할 필요가 있을까라는 생각이 들었습니다. 더욱이 사용자가 데이터베이스 칼럼을 조작하지 못하기에 에러 핸들링이 간단해지는 이점도 있었습니다.&lt;/p&gt;
&lt;p&gt;하지만, 결국 다시 노션을 선택하게 되었습니다. 사용자들이 자신이 저장한 모든 문제를 볼 수 있어야 한다고 생각했습니다. 단순히 저장하고 하나씩 추출하는 것을 넘어 사용자들이 지금까지 쌓아온 문제들을 보는 것도 의미가 있을 것이라 판단했습니다. 모든 문제를 보여주는 것은 노션이 아니어도 가능하겠지만, 노션을 활용하는 것이 사용자들에게 색다른 경험을 제공하고 또 웹페이지에서 보는 것보다는 자신의 노션에서 보는 게 접근성이 좋을 것이라 생각했습니다.&lt;/p&gt;
&lt;h2&gt;발생한 문제와 해결 방법&lt;/h2&gt;
&lt;h3&gt;노션 API는 CORS를 지원하지 않는다.&lt;/h3&gt;
&lt;p&gt;프로젝트 초반에는 단순 확장 프로그램 단독으로 동작하는 것으로 구상했습니다. 하지만, 확장 프로그램에서 직접 노션 API를 사용하려고 하니 CORS 에러가 발생했습니다. 구글링을 통해 노션 API는 CORS를 지원하지 않는다는 것을 알게 되었습니다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/05152d4e2256516b0f1ba507a16cf395/df77d/notion-api-cors.webp&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 14.117647058823529%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/webp;base64,UklGRkQAAABXRUJQVlA4IDgAAAAwAwCdASoUAAMAPtFUo0uoJKMhsAgBABoJZQCsAC0j+kgAAP7wlzZVLIwcU7aTiE3YZvIkPesQAA==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;출처: https://medium.com/hcleedev/web-same-origin-policy%EC%99%80-cors-%EC%97%90%EB%9F%AC-%EA%B7%B8%EB%A6%AC%EA%B3%A0-preflight-8e8ce5375ff3&apos; title=&apos;&apos; src=&apos;/static/05152d4e2256516b0f1ba507a16cf395/4c79d/notion-api-cors.webp&apos; srcset=&apos;/static/05152d4e2256516b0f1ba507a16cf395/33073/notion-api-cors.webp 170w,
/static/05152d4e2256516b0f1ba507a16cf395/719ab/notion-api-cors.webp 340w,
/static/05152d4e2256516b0f1ba507a16cf395/4c79d/notion-api-cors.webp 680w,
/static/05152d4e2256516b0f1ba507a16cf395/df77d/notion-api-cors.webp 720w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;출처: https://medium.com/hcleedev/web-same-origin-policy%EC%99%80-cors-%EC%97%90%EB%9F%AC-%EA%B7%B8%EB%A6%AC%EA%B3%A0-preflight-8e8ce5375ff3&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;결국 백엔드까지 구축해야 된다는 것을 알게 됐고, 이 이후부터 프로젝트의 규모가 매우 커졌습니다…&lt;/p&gt;
&lt;h3&gt;자바에서 JSON을 다루기가 만만치 않다.&lt;/h3&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/d88601ec8edbc8b2b1ddfe3ff64a0567/ea2ac/diagram1.jpg&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 51.764705882352935%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIEAQX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB7b7MjFAv/8QAGRAAAgMBAAAAAAAAAAAAAAAAAAECAxEy/9oACAEBAAEFAop4NWaVdn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPwGH/8QAGxAAAgEFAAAAAAAAAAAAAAAAARAhAgMRInL/2gAIAQEABj8C3kqKhhXOl//EABsQAAICAwEAAAAAAAAAAAAAAAERABAhQWHw/9oACAEBAAE/IU7ARcG8uP8AjMV4uV//2gAMAwEAAgADAAAAEDQP/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAx/9oACAEDAQE/EFyf/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAh/9oACAECAQE/EDDP/8QAGxABAAIDAQEAAAAAAAAAAAAAAREhABBhUfD/2gAIAQEAAT8QhEISER5hSDQ1zEqRNLQ19HGv/9k=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;초기 다이어그램: Spring 서버에서 모든 역할을 맡는다.&apos; title=&apos;&apos; src=&apos;/static/d88601ec8edbc8b2b1ddfe3ff64a0567/a22ce/diagram1.jpg&apos; srcset=&apos;/static/d88601ec8edbc8b2b1ddfe3ff64a0567/0b705/diagram1.jpg 170w,
/static/d88601ec8edbc8b2b1ddfe3ff64a0567/31389/diagram1.jpg 340w,
/static/d88601ec8edbc8b2b1ddfe3ff64a0567/a22ce/diagram1.jpg 680w,
/static/d88601ec8edbc8b2b1ddfe3ff64a0567/29373/diagram1.jpg 1020w,
/static/d88601ec8edbc8b2b1ddfe3ff64a0567/ea2ac/diagram1.jpg 1231w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;초기 다이어그램: Spring 서버에서 모든 역할을 맡는다.&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;초기 다이어그램은 위와 같습니다. 지금까지 스프링 부트로 백엔드 프로젝트를 진행해 왔기에 큰 고민 없이 스프링을 선택했습니다. 하나의 스프링 서버에서 인증, 인가를 포함한 비즈니스 로직 처리, 데이터베이스 접근과 노션 API와의 통신 등등을 담당했습니다.&lt;/p&gt;
&lt;p&gt;그러나 노션 API를 자바에서 사용하는데 불편함이 굉장히 많았습니다. JSON 형식으로 통신을 하는데 일일이 DTO를 만들어야 했고, 또 JSON의 깊이가 깊어 값을 받아오더라도 사용하는 데에 불편함이 많았습니다. 가장 큰 문제는 노션 API에서 반환되는 JSON의 키 값들이 고정되어 있지 않다는 것입니다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/55c25e7e3b78ebeeb03b632ab239ad96/a6dfb/number-type-response.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 33.529411764705884%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAmElEQVR42o2PyQrDMAxE/f8/WOilhLaJLS+SbHk91Yacm8BjTnrMSKHV6CBYgwsIYBb2Ag+ag1MUXI6YIkfGxFgTNeGZl8wz9THOgIHtAcebPOSgK9ueqWf+zyhROe93sLI/BV6NbQlHQd3knkwUtgMIXfbfyq4X6SVemqdcos8Jq9Bc26Lvs/NG7SnPv0dNo6RRZeV9qvwAH7CNWxJ44PMAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;number 타입 반환값&apos; title=&apos;&apos; src=&apos;/static/55c25e7e3b78ebeeb03b632ab239ad96/ca1dc/number-type-response.png&apos; srcset=&apos;/static/55c25e7e3b78ebeeb03b632ab239ad96/e7570/number-type-response.png 170w,
/static/55c25e7e3b78ebeeb03b632ab239ad96/f46e7/number-type-response.png 340w,
/static/55c25e7e3b78ebeeb03b632ab239ad96/ca1dc/number-type-response.png 680w,
/static/55c25e7e3b78ebeeb03b632ab239ad96/a6dfb/number-type-response.png 747w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;number 타입 반환값&lt;/figcaption&gt;
  &lt;/figure&gt;
&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/7d7e5400a752d3dbee246bfaea9980f3/134e0/title-type-response.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 75.88235294117648%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAABB0lEQVR42pWS227DIAyG+/4PuWjrknCwMRgwOdzMUbWqmpYmkX4kDP7wiRsHF70hb4OzeFpgDSHcJBOnUHKUHOeazqrERfimq7e+ty6jmQpdg9fGnEj5YruCwyx8LXLLEQByopn9VOIsea55e+WhN7Ber5JipM/BMhohI9GpWvJNN7RTyxNWQ5hGDwGwBsWcYpPCyQvZLZc38KKRKdyNB6dtg3UqSzudthqtpG5w98GO3yMDSAq/fvEY1iF/9ParN7Yfo3PtcOZ/anaIhaCYbmKvJ9qnKdMxvApjQOM8AsrWJCNhVFUcdvmXOVNlqjm2FP7v7R6s3sLhwq9+hdsj1HMwZ5WWln8A2bhWBYLMM1UAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;title 타입 반환값&apos; title=&apos;&apos; src=&apos;/static/7d7e5400a752d3dbee246bfaea9980f3/ca1dc/title-type-response.png&apos; srcset=&apos;/static/7d7e5400a752d3dbee246bfaea9980f3/e7570/title-type-response.png 170w,
/static/7d7e5400a752d3dbee246bfaea9980f3/f46e7/title-type-response.png 340w,
/static/7d7e5400a752d3dbee246bfaea9980f3/ca1dc/title-type-response.png 680w,
/static/7d7e5400a752d3dbee246bfaea9980f3/134e0/title-type-response.png 744w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;title 타입 반환값&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;스프링에서 노션을 사용한 모든 DTO를 만드는 등의 작업은 마쳤지만, 이후 이 코드를 계속 사용하고 유지보수하기에는 어려울 것 같았습니다. 실제로 개발 도중, “난이도” 칼럼도 같이 저장해 달라는 요구 사항을 받고, 노션 API를 사용하는 부분을 수정해야 했는데 코드가 너무 복잡했고 큰 스트레스로 다가왔습니다. 결국 노션 API 사용하기 위한 Express 서버를 도입하기로 했습니다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/a11b8a34155d440b74133146c9d7cac6/ea2ac/diagram2.jpg&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 51.764705882352935%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAECBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB7VqERoF//8QAGxAAAQQDAAAAAAAAAAAAAAAAAQACAxESMjP/2gAIAQEAAQUCDTiiJLfpDyX/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPwGH/8QAGxAAAQUBAQAAAAAAAAAAAAAAAQACEBFxISL/2gAIAQEABj8C9GzHHCkcTcj/xAAbEAADAAIDAAAAAAAAAAAAAAAAAREQoSExYf/aAAgBAQABPyHilIdok+6X/GqNkabH/9oADAMBAAIAAwAAABD0D//EABYRAQEBAAAAAAAAAAAAAAAAABEQIf/aAAgBAwEBPxB0n//EABcRAAMBAAAAAAAAAAAAAAAAAAEQESH/2gAIAQIBAT8QGKv/xAAbEAEAAgMBAQAAAAAAAAAAAAABABEhUfAQsf/aAAgBAQABPxBApFAqtSyUomSvkSpE4ZQnE1O9rz//2Q==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;최종 다이어그램: Express 서버에서 Notion API를 다룬다.&apos; title=&apos;&apos; src=&apos;/static/a11b8a34155d440b74133146c9d7cac6/a22ce/diagram2.jpg&apos; srcset=&apos;/static/a11b8a34155d440b74133146c9d7cac6/0b705/diagram2.jpg 170w,
/static/a11b8a34155d440b74133146c9d7cac6/31389/diagram2.jpg 340w,
/static/a11b8a34155d440b74133146c9d7cac6/a22ce/diagram2.jpg 680w,
/static/a11b8a34155d440b74133146c9d7cac6/29373/diagram2.jpg 1020w,
/static/a11b8a34155d440b74133146c9d7cac6/ea2ac/diagram2.jpg 1231w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;최종 다이어그램: Express 서버에서 Notion API를 다룬다.&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;최종적인 시스템 아키텍처는 위와 같습니다. 자바스크립트(타입스크립트)를 활용하면 쉽게 JSON를 다룰 수 있기에 보다 편리하게 노션 API를 다룰 수 있었습니다. 비록 관리해야 하는 프로젝트가 총 3개(확장 프로그램, 스프링 백엔드, Express 백엔드)가 되었지만, 자바로 변화무쌍한 JSON 객체들을 다루지 않아도 된다는 이점이 더 크게 느껴졌습니다.&lt;/p&gt;
&lt;p&gt;이제 스프링 서버에서는 인증, 인가와 비즈니스 로직, 데이터베이스 접근의 역할을 맡게 되었고, 노션과 통신하는 부분은 Express 서버에서 맡게 되었습니다.&lt;/p&gt;
&lt;h3&gt;어떻게 문제를 랜덤으로 뽑지?&lt;/h3&gt;
&lt;p&gt;노션 API에는 데이터베이스에서 랜덤으로 뽑아주는 API가 없습니다. 처음에는 직접 데이터베이스에서 랜덤으로 선택해서 가져오는 방식으로 개발을 진행했습니다. 검색해 보시면 노션 데이터베이스에서 랜덤 값을 생성하는 방법들이 나옵니다. Formula 칼럼을 추가하여 랜덤 값을 생성하는 식을 넣으면 주기적으로 각 칼럼의 값이 랜덤값이 생성됩니다. (참고: &lt;a href=&quot;https://medium.com/@andrewwongai/how-to-make-a-random-shuffle-gallery-view-in-notion-c1faf915c285&quot;&gt;https://medium.com/@andrewwongai/how-to-make-a-random-shuffle-gallery-view-in-notion-c1faf915c285&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/67bf5833a5f12a5759eb48d2cf6806f6/df77d/random-column.webp&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 44.11764705882353%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/webp;base64,UklGRkIAAABXRUJQVlA4IDYAAACwAgCdASoUAAkAPtFUo0uoJKMhsAgBABoJaQAAeyAA/vJZZwNgiRd6WL0wGSlweK28v5kAAAA=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;Formula 칼럼을 활용해서 랜덤값을 생성할 수 있다.&apos; title=&apos;&apos; src=&apos;/static/67bf5833a5f12a5759eb48d2cf6806f6/4c79d/random-column.webp&apos; srcset=&apos;/static/67bf5833a5f12a5759eb48d2cf6806f6/33073/random-column.webp 170w,
/static/67bf5833a5f12a5759eb48d2cf6806f6/719ab/random-column.webp 340w,
/static/67bf5833a5f12a5759eb48d2cf6806f6/4c79d/random-column.webp 680w,
/static/67bf5833a5f12a5759eb48d2cf6806f6/df77d/random-column.webp 720w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;Formula 칼럼을 활용해서 랜덤값을 생성할 수 있다.&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;이를 활용하여 이 값으로 정렬한 후, 첫 번째 값을 반환하는 방법으로 구현했었습니다. 하지만, 사용자 경험 차원에서는 별로 좋지 않겠다는 생각을 했습니다. 사용자 입장에서는 필요 없는 정보인데 사용자의 노션에 있는 것이 보기 좋지 않을 것 같았습니다. 그리고 사용자가 기존 자신의 데이터베이스를 사용하는 경우에는 사용자가 직접 칼럼과 랜덤값을 생성하는 식을 넣어줘야 합니다. 랜덤값 칼럼이 없는 경우도 따로 에러 핸들링을 해야 했기 때문에 다른 방식을 택하게 되었습니다.&lt;/p&gt;
&lt;p&gt;그래서 현재 구현된 방식은 모든 문제를 가져와서 그중 랜덤 인덱스의 문제를 가져오는 방식입니다. 이로 인해 사용자 입장에서는 필요 없는 랜덤값 칼럼을 유지할 필요가 없어지고, 제 입장에서도 에러 핸들링을 하지 않아도 되어 관리하기 편해졌습니다. 랜덤 추출할 때마다 노션에서 모든 문제를 가져오는 것은 코스트가 많이 들 것이라 사용자의 로컬에 문제 리스트를 모두 저장하고 로컬에서 추출하는 방식으로 구현했습니다.&lt;/p&gt;
&lt;h2&gt;남아있는 숙제&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;스프링 서버 재고&lt;/p&gt;
&lt;p&gt;이쯤 되니 굳이 스프링 서버가 있어야 하나라는 생각이 듭니다. 아직은 Express에 자세히 알지 못해 스프링 서버를 대체할 수 없지만, 이후 Express에 대해 좀 더 공부를 하고 스프링 서버를 대체하지 않을까 싶습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;에러 핸들링&lt;/p&gt;
&lt;p&gt;데이터베이스 공유와 같은 필수적인 에러 핸들링은 구현되어 있으나 이외는 아직 러프하게 되어있습니다. 이 부분을 더 세분화하여 사용자에게 더 자세히 에러를 알려주는 방식으로 진행할 것 같습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;비용&lt;/p&gt;
&lt;p&gt;이건 아마 해결하지 못할 숙제일 듯합니다. 프로젝트를 오래 유지하기 위해 처음에는 비용이 발생하지 않는 방법으로 진행하려고 했습니다. 이런 이유로 확장 프로그램으로만 동작하는 방식으로 시작했습니다. 하지만 결국 AWS EC2, RDS, Codedeploy 등까지 사용하면서 비용이 발생하게 되었습니다. 프로젝트를 계속 유지시키기 위해서는 비용을 최소화해야 하기에 계속 고민할 것 같습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;배우고 느낀 점&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;타입스크립트와 리액트&lt;/p&gt;
&lt;p&gt;이번에 사용해 보면서 자바스크립트와 자바를 합친 것 같다는 느낌을 받았습니다. 필요한 부분에서는 객체 interface나 type을 지정해 주어 사용할 때 내부 값들의 접근이 쉬웠습니다. interface나 type이 복잡한 경우에는 &lt;code class=&quot;language-text&quot;&gt;any&lt;/code&gt;를 써서 회피할 수 있는 것도 사용하는 데에 편리했습니다. 물론 깊게 써보지는 않았지만, 자바스크립트보다는 타입스크립트를 쓰는 게 더 도움 되지 않을까 싶습니다.&lt;/p&gt;
&lt;p&gt;리액트를 사용하면서 리액트로 시작하기 잘했다는 생각을 했습니다. 개발하다 보니 꽤 많은 화면을 만들고 조건부 랜더링을 해야 했습니다. 단순 HTML로 다뤘으면 중복되는 내용도 많고 로직을 다루기도 쉽지 않았을 것 같습니다. 이번 개발에 필요한 리액트 개발 방법만 익혀 사용했기에 제대로 알지는 못하지만, 화면별로 분리하고 관리하기 편하다고 느꼈습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;공식 문서와 친해졌다.&lt;/p&gt;
&lt;p&gt;이번 프로젝트를 진행하면서 크롬 개발자 문서와 노션 개발자 문서 참고를 많이 했습니다. 이전에는 공식 문서를 봐야 된다는 것을 알아도 가독성이 좋지 않다는 이유로 계속 기피했습니다. 하지만, 크롬 개발자 문서나 노션 API 문서는 정리도 잘 되어있기도 했고 사용한 레퍼런스도 많지 않아 공식 문서를 계속 참고했습니다. 이번 기회를 통해 공식 문서와 친해지지 않았나 생각합니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;개발을 들어가기 전에 사전 조사를 자세히 해야겠다.&lt;/p&gt;
&lt;p&gt;발생한 문제에서 말한 것처럼 진행하면서 아키텍처나 구현 방식을 여러 번 갈아엎었습니다. 단순 확장 프로그램만 개발한다는 첫 구상에서 백엔드, 데이터베이스, 서버, CI/CD까지 규모가 매우 커졌습니다. 물론 왕도로만 갈 수는 없겠지만, 그래도 사전에 알아보고 어느 정도 구상을 해봤으면 시간을 더 많이 아낄 수 있지 않았을까 하는 아쉬움이 남습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;실제 사용자를 받는다는 두려움&lt;/p&gt;
&lt;p&gt;단순히 프로젝트를 만들고 끝나는 것이 아니라, 실제로 다른 사람들이 내 프로젝트, 서비스를 사용한다고 하니 막연한 두려움이 생기고 더 잘 만들어야 하는 것 아닌가라는 생각이 들었습니다. 아직도 이런 마음이 없는 것은 아니지만, 개선해 나가면서 성장하는 것이고 또, 오픈 소스로 다 같이 만들어나가는 것이라 생각하며 완성했습니다. 그리고 안정적인 서비스를 만들기 위해 공부를 많이 해야겠다는 다짐하게 됐습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SSAFY를 통한 성장&lt;/p&gt;
&lt;p&gt;사실 백엔드 기술 스택에 꽤 여러 개가 사용되었습니다. AWS의 EC2, RDS, Codedeploy, GitHub Actions, Docker, Spring, Express 등등을 도입했습니다. SSAFY의 프로젝트를 통해 경험을 이미 해보았고 사용 방법들을 알고 있었기에 큰 진입 장벽, 고민 없이 도입할 수 있었던 것 같습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;출시될 때의 뿌듯함&lt;/p&gt;
&lt;p&gt;초반에 개발을 시작하면서 제대로 완성할 수 있을까라는 의구심이 들었습니다. 개발을 하면서도 몇 번의 큰 문제가 발생할 때마다 포기하고 싶다, 괜히 시작했나라는 생각이 들었습니다. 그래도 차근차근 하나씩 해결해나가다 보니 완성시킬 수 있었습니다. 그리고 크롬 웹 스토어의 승인을 받고 정식 출시가 되었을 때 굉장히 뿌듯했습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;글을 마무리하며…&lt;/h2&gt;
&lt;p&gt;앞으로 조금씩 프로젝트를 개선해 나갈 생각입니다. 상반기 채용 공고들이 나오고 있어서 큰 변화를 주지는 못하겠지만, 에러 수정 등은 꾸준히 할 예정입니다.&lt;/p&gt;
&lt;p&gt;마지막으로 프로젝트를 진행하는 데에 도움을 주신 분들께 감사 인사를 남기고 마무리하겠습니다. 먼저, ‘프로젝트는 이제 그만’이라는 닫힌 생각을 다시 열게끔 인사이트를 주신 이동욱 님께 감사드립니다. 덕분에 프로젝트를 시작할 수 있었습니다. 프로젝트에 “whileTrue”라는 이름을 붙여주시고, 페르소나가 되어주신 심부부 님, 적극적으로 의견을 내주시고 프로젝트를 지속할 수 있도록 응원해 주신 햄 님, 그리고 고민이 생기거나 결정 사항이 생길 때마다 고민 들어주시고 의견 주신 변 님까지 모두들 감사합니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/static/thankyou-c57db93a7ce585e60593ee65151698aa.gif&quot; alt=&quot;감사합니다!&quot;&gt;&lt;/p&gt;
&lt;h2&gt;관련 링크&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/modisfive/whileTrue&quot;&gt;GitHub&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://chromewebstore.google.com/detail/whiletrue/ockglcdfpkebaiaaocinjdcpiieceocn&quot;&gt;크롬 웹 스토어&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[[JPA] N+1 문제와 해결법]]></title><description><![CDATA[N+1 문제가 뭘까? 하나의 엔티티 전체를 조회하면서 그와 연관된 다른 엔티티를 조회할 때, 여러 번의 쿼리가 발생하는 문제입니다. 예를 들어, Team 엔티티와 Member 엔티티 사이에 다음과 같이 1:N…]]></description><link>https://modisfive.github.io/n+1-problem/</link><guid isPermaLink="false">https://modisfive.github.io/n+1-problem/</guid><pubDate>Sat, 30 Sep 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;N+1 문제가 뭘까?&lt;/h2&gt;
&lt;p&gt;하나의 엔티티 전체를 조회하면서 그와 연관된 다른 엔티티를 조회할 때, 여러 번의 쿼리가 발생하는 문제입니다. 예를 들어, Team 엔티티와 Member 엔티티 사이에 다음과 같이 1:N(일대다)의 관계가 있다고 해보겠습니다.&lt;/p&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 641px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/d81dffb964b3632055d9d945fc8f8a25/243e6/n%2B1-01.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 15.88235294117647%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAlUlEQVR42jXISw6CMBQAQE5hSBpLse2jpf8fNBA1gY0LXXv/m0hMmOU0JZllzqwnt+5KMMKoHQWvJY1CjietVM6FUoox7v4IIdbaZpvg+94++/31nKsFQ5FjaDYyh2iN9sY4Y7N3q8d7dY+kZsMEvui+1Qw3ALJMdVQ6xORDpIxzGBiHw3CCAZTk61JTDFNOwKgUx/Ef3xIeh7Zuwq4AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;n 1 01&apos; title=&apos;&apos; src=&apos;/static/d81dffb964b3632055d9d945fc8f8a25/243e6/n%2B1-01.png&apos; srcset=&apos;/static/d81dffb964b3632055d9d945fc8f8a25/e7570/n%2B1-01.png 170w,
/static/d81dffb964b3632055d9d945fc8f8a25/f46e7/n%2B1-01.png 340w,
/static/d81dffb964b3632055d9d945fc8f8a25/243e6/n%2B1-01.png 641w&apos; sizes=&apos;(max-width: 641px) 100vw, 641px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;/figure&gt;
&lt;p&gt;그리고 각각의 엔티티는 다음과 같이 정의되어 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Getter&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Entity&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@NoArgsConstructor&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Builder&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@AllArgsConstructor&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Id&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@GeneratedValue&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;strategy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GenerationType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;IDENTITY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Column&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;member_id&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Long&lt;/span&gt; id&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@ManyToOne&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@JoinColumn&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;team_id&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt; team&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;joinNewTeam&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt; team&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;team &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; team&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Getter&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Entity&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@NoArgsConstructor&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Id&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@GeneratedValue&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;strategy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GenerationType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;IDENTITY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Column&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;team_id&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Long&lt;/span&gt; id&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@OneToMany&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mappedBy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;team&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; cascade &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CascadeType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;ALL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; fetch &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;FetchType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;LAZY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; memberList &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ArrayList&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Builder&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Long&lt;/span&gt; id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; memberList&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;id &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; id&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;memberList &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;memberList &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; memberList&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;addNewMember&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt; member&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;memberList&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;member&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        member&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;joinNewTeam&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;총 3개의 팀이 있고, 각 팀에는 3명의 멤버가 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@BeforeEach&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; teamList &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ArrayList&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt; team &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;builder&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;팀 &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; i&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; j &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; j &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; j&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            team&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addNewMember&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;builder&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;멤버 &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; j&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

        teamList&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;team&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        teamRepository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;saveAll&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;teamList&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Service&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@RequiredArgsConstructor&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TeamService&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TeamRepository&lt;/span&gt; teamRepository&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Transactional&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;findAllMemberNameFromAllTeam&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\n========== 모든 팀 조회 ==========&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; teamList &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; teamRepository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;findAll&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;findAllMemberName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;teamList&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;findAllMemberName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; teamList&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\n========== 각 팀의 멤버 조회 ==========&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; nameList &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ArrayList&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt; team &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; teamList&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            nameList&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addAll&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;team&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getMemberList&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;toList&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; nameList&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;우리는 모든 팀을 조회하고 각 팀에 속해 있는 모든 멤버들의 이름을 가져오고 싶습니다. 이것을 하나의 쿼리로 처리하고 싶지만 실제 실행된 쿼리를 보면 여러 쿼리가 동작한다는 것을 알 수 있는데, 이것이 N+1 문제입니다.&lt;/p&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 372px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/e9f4f31c8d7e8e42fd89a0e774ffb3b1/448ef/n%2B1-02.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 271.1764705882353%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAA2CAYAAADH7bkwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAIlElEQVR42o2XW4/bxhXH9UEa26u19yJL4p3iTZRIkRIl7a603rVdb+zYaRGg6EsQtIWbGrknSBs3SZ3CjQM3jVO4aYCgLwWKon3IVzv5/4fiSnsp0IeDGVIzh2fO5TdHtZbfE7dfiN0bid0fiZMUku7dEC/bkcHeTekMJuKmkGQsfr4rWpjKFaMjG6Z3RjYhNSvOxR/NxcIGB5s3nXAhkRo3LF827ECurIyXsfE8WaPCLT+RO1D0xngm9yf78konkru6I/dMV+4Zi/EcednqyMvmUn4KuQepvaC78iIUDHBUdSS/L5s40jYsOU+2YAWFa6r59sJCpfASFt2xPNGg9GqQSja/pfzWyabSmxwoX3qY07/J7g0Ji5nEk2tidnP4zT/2XR1ylwovYnIH5rc1Wxqwrr9zqILQGUwlHO6J1RsiUGOlhO+bXqyUNNzoRDDqlYVU+JLtSR8bdQSIQWoj8nqYwIrBYp6KgyzgfBuB2WCUIZsLZTz2+qrC27AwgA8b2HSJ0bICWUeEL2LTBfiY8oLmqJHvuGZVGN0f8aRUeAF+YMRmmiWzbiqvzG7KEXz2s4MX5SjfkZHhSgEfnxBsHmHzquSQVxH9Wh1fdJAeE2xMm7YMNVPytom5jtGSEYI1hH9HWDPEXD1DxlCwKhNISgubXle2OplshQPxxgOpO6lo/Yk4w13pjPfFQCBMWNyAH1u9XJrdTJpxJnVkx9riuKtSa7gDuXZ7LH96mskfvxjIO79FKSYZAoLKgWIjGmI+kpaXiBYwSKmSDQNVo/tnpObnI/n8y0w+/DiSr55H8tqvO3L/TR0bdNEDHYnO0TgjZmSdECM0sdaSWly48sFHTRnsDuXZ3xLxUl/e/pCKqs3mynz5XMpynRFaEg9bUtt2fPnsc1vmt3x58F4ir78zlPtvJ9L0d8WB/1o+fJvtiY6jW3EhepeJviMm5k7CCpqIFuVSb3viJRrS5qovu9cN+eD3pjx6ksonj+eo6YmEIFA42lMlR5xxzupx07EECBjLMCr2VJn6KM92kEiQQuEVwxe7q4FxDhYPsPgGFu2qTcGi9OJFTVNZWYqF9KaHSpndL6HSGexIlJtSu4zI+KkuW7aNr2SSIbE9JDS/6mPkBtY3P1AqHKmaTnauqzV8x3VWr4BCq1ToJVTogMYDHOW6ogsXU7GJvIuKfaXIRJ33pgcljaC04XZlHSVJgvOkPo9cKdw0LTg+l9HBbfhrJl0kNcfKh1TAo9HS6rcIQhfwGrmse0uFPLIWRMpCWkdLKLSqHfTVsfhsRAPlfCqxFncQf9OjdKlwfaGwP92Dsyey1jLxowtx1Mjj1Nu2mvN4y9E5Hq8Y7ukja7LebsP0vhSHL6mIdou55PtH6mj0GyOuYMrLCoSqxoraxwrXNU/CDHTZncP8PTgaN55ZXpNbgCk3blFs1qp7DNXTsnFsoeGJHenwTworhnIV5Nl2U5VCrJJtpyctzBudvnp3BVDgqU5LXQvEZ6VcaoVy7ciRP3+tyfNvTXnyl32Z3RrKcJ7L+FouybQrezd3pNjPlLh9E9eBca50c9Qyrfriq7E8eDeUv39ny2dPdBBHwz0Bq8OSNJqvie6X5DlNmUqsrgnE2VLrTTz53Scazj+SL//al6OfePLGe5oqx0qsqH3meVX4jhbGwyZp44GFlnzzXSD//T6S9x925bXf9GXLKcSIR/BdIka3UP6kD5sYNZCnHTAvC0WhFoBbb5fZUrsI2kwPTHn4yJCnzxL5+PG0rAakTReXuo0k5uVP2rBm3cEYlTJHLR+iJOdlmeZTBDNGUNpL2jBJrZiVchNXwEQtJK5YFSw1zgkKPrNCePGzAeBz2aFNT9Jm27FReqzlMpn5dY5EVTb7sZpXSpn4VdKrDkPVdLFUSDhsgzYt9Da0hvWpwEnaoIY9hScSe6gqhpZ1VFvSQ+IHMCZEQcQSDPQVfFk2nD9UtIngO361Aixpoz6CYxG2/M1bWMtyZXuyrnXKxK4UNhxX0abyjWIeNunR4NgqKuBz9RtxRuEpTtHGQPu7r2hzocEA2UgDa0EeR9GmIg3pU9JoKecAVsMPOnKsr1KkxPquojf9SGIz6kvaeMeUqWRJGygMMwPIBzATXJ0JEzVWYDXjTNGYwr7wfzXrJxSWeWiguZwA6SNZa4f4EQ273cUYwvIA6OpiU4hoxueSpqLN8b28f0tHlTTl2fOWPP16KvOjPRkfTGV6uAPaJDI7uiaj/UK9c3o2QGAoGJyW3gi1HORDIKuQN98v5F//SeQPj1vyywcaoo6ijzW12QjbixFwiA2IeUpKfGkBaJPuhvLwU1OV2z//PZRXf9WW19/SxYlLsjixXlImPkmgVeEaFwqjDLW8iY704SNT3v0okW//kcqzbwL5+S/68FmGti0BdWLVuzTcPgCQKHK30NZdRXtHAvH9lh2XxGZQLjZ9kNhQtPn0sS/330pVz8JajkEVG00myeLlZSIzpSJV6zNFJI6kzZYdrtAGx6m3HFRCjv8htxQ5mHeEAMmibj0o47ykTaFaEVYMn5mr7IdO0cZRAB3MbhyXVNmzjFSCk5EsP5YZe5sUfyzLkiwWEBmpfF7pbWzUaaYqhcoqONAqNkvVv9KSjRP1Af4zZdKzm2jB31FmnmyW2nA22zRPdV5lO0eLwkUPQ6FvCQbiy0Ajxbt7A/d4XXOhp30SX7QwX1i42h+WHykJboKJZTNaNlT8ANecoQ17G1L3Iv6frC8IQ9qQPErw7mz9dhb1fU4713A7CrD0F/1Ga6o/jLSYwfm/4FBFWQ8j5RNGjO0ZSePB+RxL/+XKEhbCeUKc+QN1ZA93gYnU4N/aGWjTUR095VLTwbE76t1ay1V9DV10nqxVtFE8hGY7uirdUVeu370hk8OJTK9PlSTTPugzRzWNZHIwRm9joRD0BSROCmnzA5PZOw2NTcT1AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;n 1 02&apos; title=&apos;&apos; src=&apos;/static/e9f4f31c8d7e8e42fd89a0e774ffb3b1/448ef/n%2B1-02.png&apos; srcset=&apos;/static/e9f4f31c8d7e8e42fd89a0e774ffb3b1/e7570/n%2B1-02.png 170w,
/static/e9f4f31c8d7e8e42fd89a0e774ffb3b1/f46e7/n%2B1-02.png 340w,
/static/e9f4f31c8d7e8e42fd89a0e774ffb3b1/448ef/n%2B1-02.png 372w&apos; sizes=&apos;(max-width: 372px) 100vw, 372px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;/figure&gt;
&lt;p&gt;처음에 모든 팀을 가져오는 쿼리가 실행되고(1), 총 N개의 팀을 가져오게 됩니다. 그리고 각 팀의 멤버들에 접근해야 하기 때문에 또 다시 각 팀에 대해서 쿼리가 실행됩니다.(N)&lt;/p&gt;
&lt;p&gt;우리의 예제에서는 총 3개의 팀이 있기 때문에, 모든 팀을 조회하는 쿼리 1개와 3개의 각 팀의 멤버들에 접근하는 쿼리 3개가 실행되는 것을 볼 수 있습니다.&lt;/p&gt;
&lt;h2&gt;무엇이 문제인데?&lt;/h2&gt;
&lt;p&gt;우리는 각 팀에 속해 있는 모든 멤버들의 이름을 가져오고 싶습니다. 하지만 기존의 방식대로 하면 팀들을 조회하는 쿼리와 각 팀의 멤버들을 조회하는 쿼리가 따로 나가기 때문에 문제가 됩니다. 위에서 든 예시에서는 팀의 수가 매우 적기 때문에 추가적으로 실행되는 쿼리의 수가 적지만, 만약 팀의 수가 매우 많은 경우에는 팀의 수만큼 쿼리가 실행되기 때문에 성능에 큰 문제가 될 수 있습니다.&lt;/p&gt;
&lt;p&gt;따라서, 쿼리가 따로 실행되는 것이 아니라 한 번의 쿼리로 팀의 정보와 각 팀들의 정보를 가져오는 방법이 없는지 고민해보아야 합니다.&lt;/p&gt;
&lt;h2&gt;왜 발생할까?&lt;/h2&gt;
&lt;p&gt;N+1 문제가 왜 발생할까요? 그럼 반대로 생각해보겠습니다. N+1 문제가 발생하지 않도록 하려면 JPA가 어떻게 동작해야 할까요?&lt;/p&gt;
&lt;p&gt;모든 팀의 조회하는 쿼리와 함께 각 팀에 연관된 엔티티도 모두 조회하는 쿼리도 포함시켜서 한 번에 처리하고 전부 영속성 컨텍스트에 저장해야 합니다. 하지만, JPA가 기본적으로 이렇게 동작한다면 이 역시도 큰 문제가 될 것입니다.&lt;/p&gt;
&lt;h2&gt;FetchType.LAZY(지연 로딩)을 하면 괜찮지 않을까?&lt;/h2&gt;
&lt;p&gt;JpaRepository의 메소드들은 JPQL로 실행되는데, JPQL은 Fetch 전략과 상관없이 일단 SQL로 변환되어 실행됩니다. 즉시 로딩, 지연 로딩 같은 글로벌 Fetch 전략과 상관없이 일단 모든 팀의 정보를 가져옵니다. 그 이후에 JPA는 엔티티에 설정된 Fetch 전략에 따라 연관된 엔티티를 바로 가져올지 말지 판단합니다.&lt;/p&gt;
&lt;p&gt;따라서, N+1 문제는 즉시 로딩이나 지연 로딩과 상관 없습니다. &lt;code class=&quot;language-text&quot;&gt;FetchType.EAGER&lt;/code&gt;인 경우에는 모든 팀을 조회하는 쿼리가 수행된 이후에 추가적인 쿼리도 바로 연이어 나가고, &lt;code class=&quot;language-text&quot;&gt;FetchType.LAZY&lt;/code&gt;인 경우에는 추가 쿼리가 바로 나가지는 않지만, 각 팀에 접근해서 멤버들을 조회할 때 쿼리가 나가게 됩니다.&lt;/p&gt;
&lt;p&gt;즉, 즉시 로딩이나 지연 로딩은 연관된 엔티티를 가져오는 쿼리가 언제 나가느냐에 차이가 있을 뿐, 결과적으로 둘 다 추가적인 쿼리를 통해서 연관된 엔티티를 가져옵니다.&lt;/p&gt;
&lt;h2&gt;그럼 어떻게 해결하지?&lt;/h2&gt;
&lt;p&gt;대표적인 해결 방법으로는 Fetch Join, @EntityGraph, BatchSize를 이용하는 방법이 있습니다.&lt;/p&gt;
&lt;h2&gt;Fetch Join&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;코드 블럭으로 보기
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Query&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;select t from Team t join fetch t.memberList&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;findAllFetchJoin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sql&quot;&gt;&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;select&lt;/span&gt;
    team0_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;team_id &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; team_id1_1_0_&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    memberlist1_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;member_id &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; member_i1_0_1_&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    team0_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; name2_1_0_&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    memberlist1_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; name2_0_1_&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    memberlist1_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;team_id &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; team_id3_0_1_&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    memberlist1_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;team_id &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; team_id3_0_0__&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    memberlist1_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;member_id &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; member_i1_0_0__
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt;
    team team0_
&lt;span class=&quot;token keyword&quot;&gt;inner&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;join&lt;/span&gt;
    member memberlist1_
        &lt;span class=&quot;token keyword&quot;&gt;on&lt;/span&gt; team0_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;team_id&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;memberlist1_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;team_id&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Fetch Join은 일반 SQL에서 제공하는 기능이 아닌, JPQL에서 성능 최적화를 위해 제공하는 기능입니다. Fetch Join을 사용하면 연관된 엔티티나 컬렉션을 한 번의 SQL 쿼리로 가져올 수 있습니다.&lt;/p&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 565px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/dafd0b54d870121edf7e30ab7d61a9bc/a1277/n%2B1-03.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 10%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAd0lEQVR42g3C3Q6CIBgAUJ8mim4aPwIiH4ikE3ARTTcv8v0fo85O44e9dZnbCPbD+vmhRwNVwZAyUHDSrKJPGl4aCgObjm8+TperLxUr2+i4hDjNaaT+LZeT+MrDzsImp40+C24BEXWl3T+i6i4MFv2Na0S7C5E/ZAcdww8wbZ0AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;n 1 03&apos; title=&apos;&apos; src=&apos;/static/dafd0b54d870121edf7e30ab7d61a9bc/a1277/n%2B1-03.png&apos; srcset=&apos;/static/dafd0b54d870121edf7e30ab7d61a9bc/e7570/n%2B1-03.png 170w,
/static/dafd0b54d870121edf7e30ab7d61a9bc/f46e7/n%2B1-03.png 340w,
/static/dafd0b54d870121edf7e30ab7d61a9bc/a1277/n%2B1-03.png 565w&apos; sizes=&apos;(max-width: 565px) 100vw, 565px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;/figure&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 378px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/c30a524c6ff0a5ecc8fac89d9579221b/1b718/n%2B1-04.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 88.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACHUlEQVR42o2UiXLaQBBE+ZJUOQbiIxy671taHQgBxthxJZX//4w8aYlCSKrsqjHssjs90z29noTNExHUBzvbfNGcuWp/PCYkLN042hyttJkr1nRtXsbtypAht9fJM8W60921nxtJZWXNoxWs/WzlpSsvAZSFEuRqWCycfk0l7hPnZPn1eamTXB5/6HEZt89euTPTxhVbV3Q0xdZIaj6BoNK94c9V508yYFa2iTbPZlKTQHE73yTbkxYK4LSodIpt2r3wCSgotPNXMjey3Td648wpWo5lWTWkbTEd5LjmLL84ABJsaIf1QY+F7JMtEbcnoBU/nw+c56p1nWznbda9AsHYUIi2/WoPhB5XYXPklFnSzqMVQvvfZEi+9AUFlArIB9UBLC0SBGsn3wIHytpLL5I1ONvcQ2c098qOCujkFp2Z1mpQGHElBXfyFl3RRU7rXPlmoaGkePoOMAwl4WL/xm3EI4Ga+f4NCWk+GESBeW+SB9OnztkMdrR0E6yCSaQ3ZAxbgW2+DhcWTiQdZjN06nAg3XZveLNhMKMrR6tebn+3rVifHlbQox8GU59+gk3+u++kbxv1s90rbSM487xZqCP8aOP/J/NHBUhKMzAkBksXeoQrBbi3K326HhpW+pCMZsNinLOBPH51IAeHj4LzIxTkO0MqAlFYUwyZJ2MPPKw73UPS3luD9V2xc4sta15I/98ib3ln/I7hmJkWiV/C9vCo9Qh+qAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;n 1 04&apos; title=&apos;&apos; src=&apos;/static/c30a524c6ff0a5ecc8fac89d9579221b/1b718/n%2B1-04.png&apos; srcset=&apos;/static/c30a524c6ff0a5ecc8fac89d9579221b/e7570/n%2B1-04.png 170w,
/static/c30a524c6ff0a5ecc8fac89d9579221b/f46e7/n%2B1-04.png 340w,
/static/c30a524c6ff0a5ecc8fac89d9579221b/1b718/n%2B1-04.png 378w&apos; sizes=&apos;(max-width: 378px) 100vw, 378px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;/figure&gt;
&lt;p&gt;그리고 위 사진에서 볼 수 있다시피 Fetch Join은 Inner Join으로 수행됩니다.&lt;/p&gt;
&lt;h2&gt;@EntityGraph&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;코드 블럭으로 보기
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@EntityGraph&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;attributePaths &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;memberList&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Query&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;select t from Team t&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;findAllEntityGraph&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sql&quot;&gt;&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;select&lt;/span&gt;
    team0_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;team_id &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; team_id1_1_0_&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    memberlist1_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;member_id &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; member_i1_0_1_&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    team0_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; name2_1_0_&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    memberlist1_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; name2_0_1_&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    memberlist1_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;team_id &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; team_id3_0_1_&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    memberlist1_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;team_id &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; team_id3_0_0__&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    memberlist1_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;member_id &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; member_i1_0_0__
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt;
    team team0_
&lt;span class=&quot;token keyword&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;outer&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;join&lt;/span&gt;
    member memberlist1_
        &lt;span class=&quot;token keyword&quot;&gt;on&lt;/span&gt; team0_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;team_id&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;memberlist1_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;team_id&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;@EntityGraph의 &lt;code class=&quot;language-text&quot;&gt;attributePaths&lt;/code&gt;에 쿼리 수행 시에 같이 가져올 필드명을 지정하면 한 번에 모두 가져오게 됩니다.&lt;/p&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 451px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/3ffae394457da71dfbc43b2e91c17d9d/99c16/n%2B1-05.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 18.823529411764707%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyElEQVR42k3GwVLCMBAA0H6Mg3qgpaUQGrKbZLNJS9ICQqmKHS/+/z+oMx6ceYeXoblIPBK9GjuSn41vGcChPlg8WJOIHGAhbaEpTF2cE11bEUifeM0hM/bWwEmGs6aLc+8K4xaMVN6ZATXFDtlh40OOlO9VqbFQsJTq50+bfUZhNP5FUADbI03SjjmECnp09xojR+YYak5L4IdC/Fr9WVQia3rade14NmHgZ0jN8FX7t017L9214qnkj4pnkT5Lf3xcy0W1++8bQH47sViuZ3oAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;n 1 05&apos; title=&apos;&apos; src=&apos;/static/3ffae394457da71dfbc43b2e91c17d9d/99c16/n%2B1-05.png&apos; srcset=&apos;/static/3ffae394457da71dfbc43b2e91c17d9d/e7570/n%2B1-05.png 170w,
/static/3ffae394457da71dfbc43b2e91c17d9d/f46e7/n%2B1-05.png 340w,
/static/3ffae394457da71dfbc43b2e91c17d9d/99c16/n%2B1-05.png 451w&apos; sizes=&apos;(max-width: 451px) 100vw, 451px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;/figure&gt;
&lt;figure&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 376px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/c8b43acd5fd15c9f19790f39a4b39942/1075d/n%2B1-06.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 89.41176470588235%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACIUlEQVR42o2T6XLaQBCEeRL/sEG2sY3Qfd8nCCEuO06cvP9r5JOWEtiVVLlqatkV2zPT3bMTv+ri5uRVO6do7zVHUu3vx+RBdxduHG9Odr6RNHu6NKdLY1jPcSdfjl/BM8WioBLkZrqys+bR8NnLXrpwE4LN0s+IZzt8cWJuzhQbyBksfu5knRvF/pcWVcFq79c7kcvOm/5YdUay8spO4GlWEOzBQz7LytbJ5pXVLbdqUIBM2lcjqY241uMKUuXhA12svOECX0CdKwOm26x7pz73uKSGBZuoOaphrkWlpDqCoKh5qUwgBn0Wu59W1oTrgx7X1GTjFBszXWfdD3LJXiLKSOpnzjPFBBA1JzDYpieVmdTURwJg0Lb7blu6e7KCR8P7BB4qU+Edzl7VgSGLwECPCFcHqCIkvSz99BrsTJfWWLkXLCzgSWW4sBcfWckFL3SRBrfOlW8XOvJUxz8kTto3MCCR1y1avvAXbtWn373aaYNnZIQ8YAvfxCTwCSeZjWFNlaAQ0zIcY7gMY5Mofg753iom5kH3oMdZmEEuNl8Gczjq18dL2zdzWQ1LUjBJ5f6Dgteu/vdhcAnp4clUYSydow0d3i400o9j/G+wGJcnK0RewDSPPEhKFjg/29H4yEgkYtyPPhuAGUZhb7p9wxW/N7wkr3hhPCwmBEVenGhuBnPTn4w9oId4m5QV+tE/wczwQqL1EdvcYisGjmnR4+ovKaDxNO1CvU4AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;n 1 06&apos; title=&apos;&apos; src=&apos;/static/c8b43acd5fd15c9f19790f39a4b39942/1075d/n%2B1-06.png&apos; srcset=&apos;/static/c8b43acd5fd15c9f19790f39a4b39942/e7570/n%2B1-06.png 170w,
/static/c8b43acd5fd15c9f19790f39a4b39942/f46e7/n%2B1-06.png 340w,
/static/c8b43acd5fd15c9f19790f39a4b39942/1075d/n%2B1-06.png 376w&apos; sizes=&apos;(max-width: 376px) 100vw, 376px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;/figure&gt;
&lt;p&gt;주목할 점은 Fetch Join은 Inner Join으로 수행되는 반면, @EntityGraph는 Outer Join으로 수행된다는 것입니다.&lt;/p&gt;
&lt;h2&gt;Fetch Join과 @EntityGraph의 문제점&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;단순 Fetch Join만을 사용하면 카테시안 곱이 발생하기 때문에 일대다 관계의 일(1) 부분에서 중복 발생하게 됩니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Test&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;joinFetch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token class-name&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\n========== Fetch Join 테스트 ==========&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token class-name&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\n========== 모든 팀 조회 ==========&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; allTeams &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; teamRepository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;findAllFetchJoin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token class-name&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\n========== 모든 팀 조회 끝 ==========&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token class-name&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\n========== 각 팀의 멤버 조회 ==========&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; allMemberNames &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ArrayList&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt; team &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; allTeams&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;team&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt; member &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; team&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getMemberList&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token class-name&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;member&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            allMemberNames&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;member&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token class-name&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\n========== 각 팀의 멤버 조회 끝 ==========&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token class-name&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;allTeams = &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; allTeams&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token class-name&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;allMemberNames = &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; allMemberNames&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;figure&gt;
 &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 291px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/8e9dd5b6110505f803562a2898a3b90f/b3b34/n%2B1-07.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 337.05882352941177%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAABDCAIAAAATYLIVAAAACXBIWXMAAAsTAAALEwEAmpwYAAADOUlEQVR42p2XiW7aQBCGeZPmam7A2JjLF74wxkAMhCMEpTnavP8j9LOpaFQ1kXakkRUcz+7MP/P/s1u5Mu1ONO7GE3s4c9J5KxiZ/jCebaP8YTDfDhe7fnY/mD82+4mTLnqDKZ9hN23ne6NdqXb7rSCt9fwLo3uudzDe7v8un11+Yvt//WOVuhXYw1yzgzOt9d8vvrCKZgXT7RuRB9P1Zzt86nzbcd10rtmR7sbKzgQ82by1gxFgKDsDVZw/GN6gE2XKzqAdlc5US9kZtHHT7PC4qiujzc5OOiNz4ld2Zufx5rUdZv54KQCsH8+KnPEX1NkLpiuKjL+gzuF0+xM+kLmkVFZyR+ZCwHDWrPDoVr1UAJYsdqafsoQE7XC6NrykJ+gw2gNKtgpiqDtXO543WoA5QiNhVbZ+oUMkpdJKYly37NO6KSEGOBP8ZbMnqTMdRqn8yUrS2152z/6sItgZwJ4bTowMnevqSoKz4caFDOnq0kuRCL7hhOqib4dMjJu2WxKjq9zbqGfDiegwCasYgjjLWOVnqx+abGcqTJ3BvOklkg7LH9/hszPMJRrGfKVUh+GuBlgnHl+3HAmrCmI8vIGWO1pIwkb0WYJzjGRKTjavTAzERFKqKN/Ue77uRhLAOHXRYZJjBcSwkin7H1cN9bA7HqchnAlBoiTj9QtQe9lCgLa/Z5VE9PdokzkTR1Lnu0J6h5KJASVKYrgMDZmGzWqyUhXSu3ouz+K5JOz+eCknBrOqOLiGooOrP1lSZy4LyuMG9aTDDHdgCTSMDoPJlEo43CEjpZIMd+qcP/4iYTIXAsYSHA4kzsl8B9rU+VxwGqLD9gKoPNyZzPQ2mDOrGBqHufHhRvj3+dEKZ/L8dqOd1Iyjqn6qmVwKsdN6EzupFbb/+ee9Zh6suIhemZbuDsiZDsUIgdtdeZdNSQS2NgqdSMmLRuaJ8TFPJlSF8h5eMSuBHeOygqRRBYxDB0c0pII9AJVFm/3iSV8VOdMkHIXCuw37cDHmC7IoYzYg+RlBHsKumwcrwkZAWIk9UW9YDUPR4AujByQsdNm0vgKs2vWYj+nyabx5YXRAknz37o7mJO+N0HPvi875DcWPLoT9gjumAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;n 1 07&apos; title=&apos;&apos; src=&apos;/static/8e9dd5b6110505f803562a2898a3b90f/b3b34/n%2B1-07.png&apos; srcset=&apos;/static/8e9dd5b6110505f803562a2898a3b90f/e7570/n%2B1-07.png 170w,
/static/8e9dd5b6110505f803562a2898a3b90f/b3b34/n%2B1-07.png 291w&apos; sizes=&apos;(max-width: 291px) 100vw, 291px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;/figure&gt;
&lt;figure&gt;
 &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 313px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/6f428d42bd7bff13ec86c0454b7198af/8e749/n%2B1-08.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 197.64705882352942%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAIAAABxU02MAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEHElEQVR42nVWZ5OjVhDU//9Lrjrfle3bcFolEAgQOQeRUQTkfiQldksfngRNT890DztZzfkffwk/fwh/3jlqyfIs/fav+Od9K/H0x388fpxNOZGnP39zH2/8fMrhhukH/8+vrSoxE3olzKbm/MtYU7ooGAK/+fX3+vNdUESWWijU0tgwhqHy1FJaLXDWFWn78cZOPzXblCbhzrxeL9f6XFXn67X2PHux+JBlzraM4zHDpbouizwtipjcdi33RbqmZ1kWnU/FJPDtsqwvl/JywbVrEPgURUuS7Dr2fr8vy6qu6ySOwjCsqrqqqqLIJFEsisMJ4F1gX0ogz+fzqa4r33OWq4WqKK5rF0WOK1VVJkkURTsc8DXLUkHg8jw/HrKJ75kNawcG5utrut0KlmXkedaCQbzb+S04z1A2hYedjvnENOTL5Qb2PGc+nymKsgv8PE9xd8uWJHF7xo8UtYrjmIAtU3kFa5oKqpYZH5Qdx2FZtmUnPLchZR+zialL92BoXq2Wqgpmr2VGtaTqwO81J9stXxQF0fwEBvNs9kXAOx/VduAoDIKbZmZNd2U/g11StixLrmNhKr3m5F4zTX+vebGYi6LoOPYATtMYsgcwx23SNB1hbkclilvHsYZRhah60JyShhX7VvPTqFwbmjHngXlEM0NH35W9XC50XTNNvW1YW3Yc38per6m+YYZ0Jn+n0+mIZ4MZmi3L0jQFOvFQfFrN7RnNY5k1wKRs21Jbx6OmPhiU4zimSeyJVOBH3Ipg4ICvMDw6sj8cz6c9adg9MxqGUQFp6FqaJqCC8aPGJWUTATBvNixG1zA/avYbzbaNwg2AB3sOqYJmlmUAJpp1TXwdFVqNA5o0ANKHYCyjOBoBew0YzMC34HZUKHvwNjcEwxgLBpCYWZzEuL8B7+7zjGWQZdk482w2dV0HZUNqy4xmD8xkGaz7ZaAqwmsw0G1dVzHeQefQvIdgaOp2FGwYWp+kshnzyw6D5ueym1FZljmAe833DWO7BShL3OuourLvwEHg3WmmO82urb2mSpJEgBvmbs6PC3DZaX4C+76LUWGT9OARh/F8Pyrs7T4X7RvDA1jXdRg0zxCMCnHAU7C6m1yQNwaCcTgeyOvGc43z5TGSZG/LOolkTIJRXhrN/hAMeLuL5OgCxN5uTAKHjSxAvDFgvhGT+P0mcZ1bMJ7Amw3TgbVnhxF7qmBuwGVjTzgkuFv6PL/plv6LPcmcVVUdItnPeQhGwmANJaP2bN5VKBsmexxVeP+W7Oasj4FhkjtvPwcDq/cWDOCewLIsm997G8HoNatCE/ju3wrPc2eEWcYGBB3cA2dAPNDEIlWFlcowTJpmxCSWIaZJmOcRnoTvgW9tWErXJKzkOPJRGz5x5IWB056zZCduWVw6FOH/1ai+yJ77ScoAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;n 1 08&apos; title=&apos;&apos; src=&apos;/static/6f428d42bd7bff13ec86c0454b7198af/8e749/n%2B1-08.png&apos; srcset=&apos;/static/6f428d42bd7bff13ec86c0454b7198af/e7570/n%2B1-08.png 170w,
/static/6f428d42bd7bff13ec86c0454b7198af/8e749/n%2B1-08.png 313w&apos; sizes=&apos;(max-width: 313px) 100vw, 313px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;/figure&gt;
&lt;p&gt;이를 해결하기 위해서는 JPQL의 DISTINCT 키워드를 사용하거나 Set 컬렉션을 이용해서 중복되는 값을 제거해야 합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Query&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;select distinct t from Team t join fetch t.memberList&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;findAllDistinctFetchJoin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@EntityGraph&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;attributePaths &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;memberList&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Query&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;select distinct t from Team t&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;findAllDistinctEntityGraph&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Set을 이용하는 경우&lt;/span&gt;

&lt;span class=&quot;token annotation punctuation&quot;&gt;@Query&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;select t from Team t join fetch t.memberList&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token class-name&quot;&gt;Set&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;findAllFetchJoinBySet&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;페이징 처리가 어렵습니다. Fetch Join과 @EntityGraph에서는 페이징 API를 지원하지 않기 때문에 페이징 처리를 할 수 없습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;BatchSize&lt;/h2&gt;
&lt;p&gt;BatchSize 값을 설정하면 한 번의 쿼리로 연관된 데이터 몇 개를 가져올 지를 지정할 수 있습니다. 예를 들어 70개의 가져올 데이터가 있고 BatchSize가 30인 경우, 총 3번의 쿼리로 30개, 30개, 10개씩 가져오게 됩니다. 하나의 쿼리로 모든 데이터를 조회할 수는 없지만(전체 데이터 수가 BatchSize보다 큰 경우), 기존의 N+1 문제에서 발생한 쿼리 수보다는 적게 발생합니다.&lt;/p&gt;
&lt;h2&gt;참고&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://jojoldu.tistory.com/165&quot;&gt;[블로그] JPA N+1 문제 및 해결방안 (향로 님)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://brunch.co.kr/@jinyoungchoi95/2&quot;&gt;[블로그] JPA N+1 발생 케이스와 해결책 (최진영 님)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.inflearn.com/course/ORM-JPA-Basic&quot;&gt;[인프런 강의] 자바 ORM 표준 JPA 프로그래밍 - 기본편 (김영한 님)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item></channel></rss>